{"version":3,"sources":["/source/jsonapi.module.js","/source/utils/lazy-property.js","/source/utils/all-settled.js","/source/synchronization/synchronization.js","angular-jsonapi.min.js","/source/synchronization/synchronization-rest.js","/source/synchronization/synchronization-local.js","/source/abstract-data/schema.js","/source/abstract-data/model.factory.js","/source/abstract-data/abstract-data.js","/source/abstract-data/abstract-data-form.js","/source/collection/collection.factory.js","/source/jsonapi.provider.js"],"names":["angular","module","constant","target","propertyName","callback","result","done","Object","defineProperty","get","call","enumerable","configurable","config","$provide","decorator","$delegate","$q","allSettled","promises","wrap","promise","when","then","value","success","reason","wrapped","isArray","forEach","key","hasOwnProperty","all","AngularJsonAPISynchronizationWrapper","AngularJsonAPISynchronization","_this","this","allHooks","state","beginHooks","beforeHooks","synchronizationHooks","afterHooks","finishHooks","options","hookName","loading","extend","synchronization","extendHooks","hooksKey","hooks","concat","begin","action","push","finish","beforeSynchro","afterSynchro","synchronize","collection","object","linkSchema","linkedObject","params","undefined","loadingCount","hook","results","prototype","before","after","factory","$inject","AngularJsonAPISynchronizationRestWrapper","$http","AngularJsonAPISynchronizationRest","url","wrapResp","data","status","headers","afterAll","rawData","included","indexedData","id","addOrUpdate","__remove","allCollections","type","afterGet","error","deferred","defer","method","resolve","reject","ids","toString","remove","removeLink","linkKey","removed","toLink","addLink","update","toPatchData","add","console","log","toJson","create","constructor","AngularJsonAPISynchronizationLocalWrapper","$window","AngularJsonAPISynchronizationLocal","prefix","init","datas","localStorage","getItem","Model","schema","fromJson","clear","removeItem","updateStorage","setItem","__updateStorage","AngularJsonAPISchemaWrapper","$log","AngularJsonAPISchema","include","relationships","linkName","linkSchemaObj","AngularJsonAPILinkSchema","length","join","isString","model","polymorphic","reflection","JsonAPIModelFactory","AngularJsonAPIAbstractData","modelFactory","schemaObj","linkedCollections","parentCollection","updatedAt","dummy","form","parent","functions","metaFunction","metaFunctionName","AngularJsonAPIAbstractDataWrapper","uuid4","lazyProperty","AngularJsonAPIAbstractDataForm","attributes","errors","validation","__setUpdated","__setData","refresh","__synchronize","Date","now","removeAllLinks","res","val","addLinkById","linkModelName","__get","validate","linkType","reflectionKey","linkAttributes","warn","duplicate","link","__setLinkInternal","index","splice","__updateAttributes","validatedAttributes","__setAttributes","getAll","getSingle","__setLink","indexedLinks","__setLinks","__validateField","__validate","__validateData","validator","attributeName","safeData","copy","attributeValue","element","isFunction","err","parseInt","isObject","maxlength","minlength","maxvalue","minvalue","AngularJsonAPIAbstractDataFormWrapper","reset","save","equals","validateField","AngularJsonAPICollectionWrapper","AngularJsonAPICollection","__saveDummy","bind","json","objectData","validatedData","newModel","generate","jsonapiProvider","jsonapiFactory","addModel","memory","getModel","$get","provider"],"mappings":"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","file":"angular-jsonapi.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi', ['uuid4']);\n\n})();\n","// from https://www.sitepen.com/blog/2012/10/19/lazy-property-access/\n(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n    .constant('lazyProperty', function(target, propertyName, callback) {\n      var result;\n      var done;\n      Object.defineProperty(target, propertyName, {\n        get: function() { // Define the getter\n          if (!done) {\n            // We cache the result and only compute once.\n            done = true;\n            result = callback.call(target);\n          }\n\n          return result;\n        },\n\n        // Keep it enumerable and configurable, certainly not necessary.\n        enumerable: true,\n        configurable: true\n      });\n    });\n\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi').config(['$provide', function($provide) {\n    $provide.decorator('$q', ['$delegate', function($delegate) {\n      var $q = $delegate;\n\n      $q.allSettled = $q.allSettled || function allSettled(promises) {\n        // Implementation of allSettled function from Kris Kowal's Q:\n        // https://github.com/kriskowal/q/wiki/API-Reference#promiseallsettled\n        // by Michael Kropat from http://stackoverflow.com/a/27114615/1400432 slightly modified\n\n        var wrapped = angular.isArray(promises) ? [] : {};\n\n        angular.forEach(promises, function(promise, key) {\n          if (!wrapped.hasOwnProperty(key)) {\n            wrapped[key] = wrap(promise);\n          }\n        });\n\n        return $q.all(wrapped);\n\n        function wrap(promise) {\n          return $q.when(promise)\n            .then(function(value) {\n              return { success: true, value: value };\n            },\n\n            function(reason) {\n              return { success: false, reason: reason };\n            });\n        }\n      };\n\n      return $q;\n    }]);\n  }]);\n\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .factory('AngularJsonAPISynchronization', AngularJsonAPISynchronizationWrapper);\n\n  function AngularJsonAPISynchronizationWrapper($q) {\n    AngularJsonAPISynchronization.prototype.before = beforeSynchro;\n    AngularJsonAPISynchronization.prototype.after = afterSynchro;\n    AngularJsonAPISynchronization.prototype.begin = begin;\n    AngularJsonAPISynchronization.prototype.finish = finish;\n    AngularJsonAPISynchronization.prototype.synchronization = synchronization;\n    AngularJsonAPISynchronization.prototype.synchronize = synchronize;\n    AngularJsonAPISynchronization.prototype.extend = extend;\n\n    return AngularJsonAPISynchronization;\n\n    function AngularJsonAPISynchronization() {\n      var _this = this;\n      var allHooks = [\n        'add',\n        'init',\n        'get',\n        'all',\n        'clear',\n        'remove',\n        'removeLink',\n        'removeLinkReflection',\n        'addLink',\n        'addLinkReflection',\n        'update',\n        'refresh'\n      ];\n\n      _this.state = {};\n\n      _this.beginHooks = {};\n      _this.beforeHooks = {};\n      _this.synchronizationHooks = {};\n      _this.afterHooks = {};\n      _this.finishHooks = {};\n\n      _this.options = {};\n\n      angular.forEach(allHooks, function(hookName) {\n        _this.beginHooks[hookName] = [];\n        _this.beforeHooks[hookName] = [];\n        _this.synchronizationHooks[hookName] = [];\n        _this.afterHooks[hookName] = [];\n        _this.finishHooks[hookName] = [];\n        _this.state[hookName] = {\n          loading: false,\n          success: true\n        };\n      });\n    }\n\n    function extend(synchronization) {\n      var _this = this;\n\n      extendHooks('beginHooks');\n      extendHooks('beforeHooks');\n      extendHooks('synchronizationHooks');\n      extendHooks('afterHooks');\n      extendHooks('finishHooks');\n\n      function extendHooks(hooksKey) {\n        angular.forEach(synchronization[hooksKey], function(hooks, key) {\n          _this[hooksKey][key] = _this[hooksKey][key].concat(hooks);\n        });\n      }\n\n      angular.extend(_this.options, synchronization.options);\n    }\n\n    function begin(action, callback) {\n      var _this = this;\n\n      _this.beginHooks[action].push(callback);\n    }\n\n    function finish(action, callback) {\n      var _this = this;\n\n      _this.finishHooks[action].push(callback);\n    }\n\n    function beforeSynchro(action, callback) {\n      var _this = this;\n\n      _this.beforeHooks[action].push(callback);\n    }\n\n    function afterSynchro(action, callback) {\n      var _this = this;\n\n      _this.afterHooks[action].push(callback);\n    }\n\n    function synchronization(action, callback) {\n      var _this = this;\n\n      _this.synchronizationHooks[action].push(callback);\n    }\n\n    function synchronize(action, collection, object, linkSchema, linkedObject, params) {\n      var _this = this;\n      var promises = [];\n\n      _this.state[action].loading = true;\n\n      if (object !== undefined) {\n        object.loadingCount += 1;\n      }\n\n      if (collection !== undefined) {\n        collection.loadingCount += 1;\n      }\n\n      angular.forEach(_this.beginHooks[action], function(hook) {\n        hook.call(_this, collection, object, linkSchema, linkedObject, params);\n      });\n\n      angular.forEach(_this.beforeHooks[action], function(hook) {\n        hook.call(_this, collection, object, linkSchema, linkedObject, params);\n      });\n\n      angular.forEach(_this.synchronizationHooks[action], function(hook) {\n        promises.push(hook.call(_this, collection, object, linkSchema, linkedObject, params));\n      });\n\n      $q.allSettled(promises).then(function(results) {\n        _this.state[action].success = true;\n        angular.forEach(results, function(result) {\n          if (result.success === false) {\n            _this.state[action].success = false;\n          }\n        });\n\n        angular.forEach(_this.afterHooks[action], function(hook) {\n          hook.call(_this, collection, object, linkSchema, linkedObject, params, results);\n        });\n\n        angular.forEach(_this.finishHooks[action], function(hook) {\n          hook.call(_this, collection, object, linkSchema, linkedObject, params);\n        });\n\n        _this.state[action].loading = false;\n\n        if (object !== undefined) {\n          object.loadingCount -= 1;\n        }\n\n        if (collection !== undefined) {\n          collection.loadingCount -= 1;\n        }\n      });\n    }\n\n  }\n})();\n","!function(){\"use strict\";angular.module(\"angular-jsonapi\",[\"uuid4\"])}(),function(){\"use strict\";angular.module(\"angular-jsonapi\").constant(\"lazyProperty\",function(t,e,n){var o,a;Object.defineProperty(t,e,{get:function(){return a||(a=!0,o=n.call(t)),o},enumerable:!0,configurable:!0})})}(),function(){\"use strict\";angular.module(\"angular-jsonapi\").config([\"$provide\",function(t){t.decorator(\"$q\",[\"$delegate\",function(t){var e=t;return e.allSettled=e.allSettled||function(t){function n(t){return e.when(t).then(function(t){return{success:!0,value:t}},function(t){return{success:!1,reason:t}})}var o=angular.isArray(t)?[]:{};return angular.forEach(t,function(t,e){o.hasOwnProperty(e)||(o[e]=n(t))}),e.all(o)},e}])}])}(),function(){\"use strict\";function t(t){function e(){var t=this,e=[\"add\",\"init\",\"get\",\"all\",\"clear\",\"remove\",\"removeLink\",\"removeLinkReflection\",\"addLink\",\"addLinkReflection\",\"update\",\"refresh\"];t.state={},t.beginHooks={},t.beforeHooks={},t.synchronizationHooks={},t.afterHooks={},t.finishHooks={},t.options={},angular.forEach(e,function(e){t.beginHooks[e]=[],t.beforeHooks[e]=[],t.synchronizationHooks[e]=[],t.afterHooks[e]=[],t.finishHooks[e]=[],t.state[e]={loading:!1,success:!0}})}function n(t){function e(e){angular.forEach(t[e],function(t,o){n[e][o]=n[e][o].concat(t)})}var n=this;e(\"beginHooks\"),e(\"beforeHooks\"),e(\"synchronizationHooks\"),e(\"afterHooks\"),e(\"finishHooks\"),angular.extend(n.options,t.options)}function o(t,e){var n=this;n.beginHooks[t].push(e)}function a(t,e){var n=this;n.finishHooks[t].push(e)}function i(t,e){var n=this;n.beforeHooks[t].push(e)}function r(t,e){var n=this;n.afterHooks[t].push(e)}function s(t,e){var n=this;n.synchronizationHooks[t].push(e)}function l(e,n,o,a,i,r){var s=this,l=[];s.state[e].loading=!0,void 0!==o&&(o.loadingCount+=1),void 0!==n&&(n.loadingCount+=1),angular.forEach(s.beginHooks[e],function(t){t.call(s,n,o,a,i,r)}),angular.forEach(s.beforeHooks[e],function(t){t.call(s,n,o,a,i,r)}),angular.forEach(s.synchronizationHooks[e],function(t){l.push(t.call(s,n,o,a,i,r))}),t.allSettled(l).then(function(t){s.state[e].success=!0,angular.forEach(t,function(t){t.success===!1&&(s.state[e].success=!1)}),angular.forEach(s.afterHooks[e],function(e){e.call(s,n,o,a,i,r,t)}),angular.forEach(s.finishHooks[e],function(t){t.call(s,n,o,a,i,r)}),s.state[e].loading=!1,void 0!==o&&(o.loadingCount-=1),void 0!==n&&(n.loadingCount-=1)})}return e.prototype.before=i,e.prototype.after=r,e.prototype.begin=o,e.prototype.finish=a,e.prototype.synchronization=s,e.prototype.synchronize=l,e.prototype.extend=n,e}angular.module(\"angular-jsonapi\").factory(\"AngularJsonAPISynchronization\",t),t.$inject=[\"$q\"]}(),function(){\"use strict\";function t(t,e,n){function o(o){function a(t,e,n,o){return{data:t,status:e,headers:n,config:o}}function i(t,e,n,o,a,i){var r=i[0].value.data.data,s=i[0].value.data.included;if(i[0].success===!0&&void 0!==r){var l={};angular.forEach(r,function(e){l[e.id]=e,t.addOrUpdate(e)}),angular.forEach(t.data,function(e){void 0===l[e.id]&&t.__remove(e.id)}),angular.forEach(s,function(e){t.allCollections[e.type].addOrUpdate(e)})}}function r(t,e,n,o,a,i){var r,s;i[0].success===!0?(r=i[0].value.data.data,s=i[0].value.data.included,t.addOrUpdate(r),angular.forEach(s,function(e){t.allCollections[e.type].addOrUpdate(e)})):(e.error=!0,e.__remove(),t.__remove(e.data.id))}function s(t,i,r){var s=e.defer(),l={method:\"GET\",url:o,params:r||{}};return n(l).success(function(t,e,n,o){s.resolve(a(t,e,n,o))}).error(function(t,e,n,o){s.reject(a(t,e,n,o))}),s.promise}function l(t,i,r,s,l){var d,c,u=e.defer();return angular.isArray(i)?(c=[],angular.forEach(i,function(t){c.push(t.data.id)})):c=i.data.id,d={method:\"GET\",url:o+\"/\"+c.toString(),params:l||{}},n(d).success(function(t,e,n,o){u.resolve(a(t,e,n,o))}).error(function(t,e,n,o){u.reject(a(t,e,n,o))}),u.promise}function d(t,i){var r=e.defer(),s={method:\"DELETE\",url:o+\"/\"+i.data.id};return n(s).success(function(t,e,n,o){r.resolve(a(t,e,n,o))}).error(function(t,e,n,o){r.reject(a(t,e,n,o))}),r.promise}function c(t,i,r,s){var l,d=e.defer();return i.removed===!0||void 0===s?d.resolve():(l={method:\"DELETE\",url:o+\"/\"+i.data.id+\"/relationships/\"+r,data:{data:s.toLink()}},n(l).success(function(t,e,n,o){d.resolve(a(t,e,n,o))}).error(function(t,e,n,o){d.reject(a(t,e,n,o))})),d.promise}function u(t,i,r,s){var l=e.defer(),d={method:\"POST\",url:o+\"/\"+i.data.id+\"/relationships/\"+r,data:{data:s.toLink()}};return n(d).success(function(t,e,n,o){l.resolve(a(t,e,n,o))}).error(function(t,e,n,o){l.reject(a(t,e,n,o))}),l.promise}function p(t,i){var r=e.defer(),s={method:\"PATCH\",url:o+\"/\"+i.data.id,data:{data:i.toPatchData()}};return n(s).success(function(t,e,n,o){r.resolve(a(t,e,n,o))}).error(function(t,e,n,o){r.reject(a(t,e,n,o))}),r.promise}function f(t,i){var r=e.defer();console.log(i);var s={method:\"POST\",url:o+\"/\",data:{data:i.toJson()}};return n(s).success(function(t,e,n,o){r.resolve(a(t,e,n,o))}).error(function(t,e,n,o){r.reject(a(t,e,n,o))}),r.promise}var h=this;t.call(h),h.synchronization(\"remove\",d),h.synchronization(\"removeLink\",c),h.synchronization(\"addLink\",u),h.synchronization(\"update\",p),h.synchronization(\"add\",f),h.synchronization(\"all\",s),h.synchronization(\"get\",l),h.synchronization(\"refresh\",l),h.after(\"all\",i),h.after(\"get\",r),h.after(\"refresh\",r)}return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o}angular.module(\"angular-jsonapi-rest\",[\"angular-jsonapi\"]).factory(\"AngularJsonAPISynchronizationRest\",t),t.$inject=[\"AngularJsonAPISynchronization\",\"$q\",\"$http\"]}(),function(){\"use strict\";function t(t,e){function n(n){function o(t){var o=e.localStorage.getItem(n+\".\"+t.Model.prototype.schema.type);t.fromJson(o)}function a(t){e.localStorage.removeItem(n+\".\"+t.Model.prototype.schema.type)}function i(t){e.localStorage.setItem(n+\".\"+t.Model.prototype.schema.type,t.toJson())}var r=this;r.__updateStorage=i,t.call(r),r.begin(\"init\",o),r.begin(\"clear\",a),r.begin(\"remove\",i),r.begin(\"removeLink\",i),r.begin(\"removeLinkReflection\",i),r.begin(\"addLink\",i),r.begin(\"addLinkReflection\",i),r.begin(\"update\",i),r.begin(\"add\",i),r.finish(\"get\",i),r.finish(\"all\",i),r.finish(\"init\",i),r.finish(\"clear\",i),r.finish(\"remove\",i),r.finish(\"removeLink\",i),r.finish(\"removeLinkReflection\",i),r.finish(\"addLink\",i),r.finish(\"addLinkReflection\",i),r.finish(\"update\",i),r.finish(\"add\",i),r.finish(\"get\",i),r.finish(\"all\",i)}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n}angular.module(\"angular-jsonapi-local\",[\"angular-jsonapi\"]).factory(\"AngularJsonAPISynchronizationLocal\",t),t.$inject=[\"AngularJsonAPISynchronization\",\"$window\"]}(),describe(\"AngularJsonAPICollection factory\",function(){beforeEach(module(\"angular-jsonapi\")),it(\"returns valid model\",inject(function(t){expect(t).to.be.ok}))}),function(){\"use strict\";function t(t,e,n,o){function a(t,e){var a=this,i=new o(t);a.Model=n.model(i,a.allCollections,a),a.synchronization=e,a.loadingCount=0,a.data={},a.removed={},a.schema=i,a.dummy=new a.Model({type:t.type},void 0,!0),a.dummy.form.save=h.bind(a.dummy),a.allCollections[t.type]=a,a.__synchronize(\"init\")}function i(t){var e=this,n=angular.fromJson(t);null!==n&&void 0!==n.data&&(e.updatedAt=n.updatedAt,angular.forEach(n.data,function(t){var n=t.data;e.addOrUpdate(n,t.updatedAt)}))}function r(){var t=this,e={data:{},updatedAt:t.updatedAt};return angular.forEach(t.data,function(t,n){e.data[n]=t.toJson()}),angular.toJson(e)}function s(e,n){var o=this;return void 0===e.id?void t.error(\"Can't add data without id!\",e):(void 0===o.data[e.id]?o.data[e.id]=new this.Model(e,n):(o.data[e.id].__setData(e,n),o.data[e.id].__setLinks(e.relationships)),o.data[e.id].__setUpdated(n),o.data[e.id])}function l(t){var e=this;return void 0===e.data[t]&&(e.data[t]=new e.Model({id:t,type:e.Model.prototype.schema.type},void 0,!0)),e.data[t]}function d(t){var e,n=this;return angular.isArray(t)?(e=[],angular.forEach(t,function(t){e.push(n.__get(t))})):e=n.__get(t),n.__synchronize(\"get\",e,void 0,void 0,n.schema.params.get),e}function c(){var t=this;return t.__synchronize(\"all\",void 0,void 0,void 0,t.schema.params.all),t.data}function u(){var t=this;t.updatedAt=Date.now(),t.data={},t.__synchronize(\"clear\")}function p(t){var e=this,n=e.data[t];e.removed[t]=n,e.updatedAt=Date.now(),delete e.data[t]}function f(e){var n=this,o=n.data[e];void 0!==o?(n.__remove(e),o.__remove(e)):t.error(\"Object with this id does not exist\"),n.__synchronize(\"remove\",o)}function h(){var n,o=this,a=o.form.validate();if(angular.equals(a,{})){var i=angular.copy(o.form.data);if(void 0===i.id)i.id=e.generate();else if(!e.validate(i.id))return void t.error(\"Wrong id of dummy data!\");i.relationships={},i.type=o.schema.type,n=o.parentCollection.addOrUpdate(i),o.form.reset(),o.parentCollection.__synchronize(\"add\",o)}}function v(e,n,o,a,i){var r=this;t.log(\"Synchro Collection\",this.Model.prototype.schema.type,{action:e,object:n,linkKey:o,linkedObject:a,params:i}),r.synchronization.synchronize(e,r,n,o,a,i)}return a.prototype.allCollections={},a.prototype.__synchronize=v,a.prototype.__get=l,a.prototype.__remove=p,a.prototype.get=d,a.prototype.all=c,a.prototype.remove=f,a.prototype.clear=u,a.prototype.fromJson=i,a.prototype.toJson=r,a.prototype.addOrUpdate=s,a}angular.module(\"angular-jsonapi\").factory(\"AngularJsonAPICollection\",t),t.$inject=[\"$log\",\"uuid4\",\"JsonAPIModelFactory\",\"AngularJsonAPISchema\"]}(),function(){\"use strict\";function t(t){function e(t){var e=this,o=[];e.params={get:{},all:{}},angular.forEach(t.relationships,function(e,a){var i=new n(e,a,t.type);t.relationships[a]=i,i.included===!0&&o.push(a)}),angular.extend(e,t),o.length>0&&(e.params.get.include=o.join(\",\"))}function n(e,n,o){var a=this;angular.isString(e)?(a.model=n,a.type=e,a.polymorphic=!1,a.reflection=o):(void 0===e.type&&t.error(\"Schema of link without a type: \",e,n),a.model=e.model||n,a.type=e.type,a.polymorphic=e.polymorphic||!1,a.reflection=e.reflection||o,a.included=e.included||!1)}return e}angular.module(\"angular-jsonapi\").factory(\"AngularJsonAPISchema\",t),t.$inject=[\"$log\"]}(),describe(\"JsonAPIModelFactory factory\",function(){var t={type:\"novels\",id:\"uuid4\",title:\"string\",part:\"integer\",links:{author:\"hasOne\",dieties:\"hasMany\"}},e={author:function(t){return{id:t,name:\"Howard Phillips Lovecraft\"}},dieties:function(t){return[{id:t[0],name:\"Shub-Niggurath\"},{id:t[1],name:\"Evil twins Nug and Yeb\"}]}},n={type:\"novels\",id:\"975fe66c-43c6-46cb-98fe-1cac46370de2\",title:\"An Epicure in the Terrible\",part:1,links:{self:\"http://example.com/novels/1\",author:{self:\"http://example.com/novels/1/links/author\",related:\"http://example.com/novels/1/author\",linkage:{type:\"people\",id:\"873edec0-5266-463f-9fd4-24365637b4f4\"}},dieties:{self:\"http://example.com/novels/1/links/dieties\",related:\"http://example.com/novels/1/dieties\",linkage:[{type:\"dieties\",id:\"0214cffb-3269-47df-a910-13088d3344cb\"},{type:\"dieties\",id:\"1d75c7bc-4c4f-4923-98d4-a53caa137c09\"}]}}};beforeEach(module(\"angular-jsonapi\"));var o,a,i;beforeEach(inject(function(r){var s=angular.copy(n);o=r.model(t,e).model,a=new o(n),s.id=\"adsad\",s.title=34,s.part=\"asdasd\",i=new o(s)})),it(\"is ok\",inject(function(n){expect(n).to.be.ok,expect(o).to.be.ok,expect(o.prototype.schema).to.deep.equal(t),expect(o.prototype.linkGetters).to.deep.equal(e)})),it(\"validates validNovel\",function(){expect(a.errors.title).to.be.empty,expect(a.errors.part).to.be.empty}),it(\"produces errors for invalidNovel\",function(){expect(i.errors.validation.title).to.have.length(1),expect(i.errors.validation.part).to.have.length(1),expect(i.errors.validation.id).to.have.length(1)}),it(\"set links for hasOne\",function(){expect(a.links.author(\"id\")).to.deep.equal(e.author(\"873edec0-5266-463f-9fd4-24365637b4f4\"))}),it(\"set links for hasMany\",function(){expect(a.links.dieties()).to.deep.equal(e.dieties([\"0214cffb-3269-47df-a910-13088d3344cb\",\"1d75c7bc-4c4f-4923-98d4-a53caa137c09\"]))}),it(\"can be updated by valid form\",function(){a.form.data.title=\"New title\",expect(a.form.save()).to.be.fulfilled,expect(a.data.title).to.equal(\"New title\")}),it(\"cannot be updated by invalid form\",function(){a.form.data.part=\"wrong\";var t=a.form.save();expect(t).to.be.rejected,expect(a.data.part).to.equal(1)})}),function(){\"use strict\";function t(t,e,n){function o(e,o,a){var i=function(e,o,a){var i=this;e.type!==i.schema.type&&n.error(\"Data type other then declared in schema: \",e.type,\" instead of \",i.schema.type),t.call(i,e,o,a),i.form.parent=i};return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype.schema=e,i.prototype.linkedCollections=o,i.prototype.parentCollection=a,angular.forEach(e.functions,function(t,e){i.prototype[e]=function(){return t.call(this)}}),i}return{model:o}}angular.module(\"angular-jsonapi\").factory(\"JsonAPIModelFactory\",t),t.$inject=[\"AngularJsonAPIAbstractData\",\"AngularJsonAPISchema\",\"$log\"]}(),describe(\"AngularJsonAPIAbstractData factory\",function(){}),function(){\"use strict\";function t(t,e,n,o){function a(t,e,n){var a=this;t.relationships=t.relationships||{},a.removed=!1,a.loadingCount=0,a.data={relationships:{},attributes:{}},a.relationships={},a.errors={validation:{}},a.dummy=n||!1,a.error=!1,a.__setUpdated(e),a.__setData(t,e),a.form=new o(a)}function i(){var t=this;t.parentCollection.__synchronize(\"refresh\",t)}function r(){var t=this;return{data:t.data,updatedAt:t.updatedAt}}function s(t){var e=this;e.updatedAt=t||Date.now(),e.parentCollection.updatedAt=e.updatedAt}function l(){var t=this;t.__setUpdated(),t.removed=!0,t.removeAllLinks()}function d(){var t=this;t.__remove(),t.parentCollection.remove(t.data.id)}function c(){return{type:this.data.type,id:this.data.id}}function u(){var t=this,e={data:{}};return angular.forEach(t.data,function(t,n){\"relationships\"!==n&&(e.data[n]=t)}),e}function p(n,o,a){var i=this,r=i.linkedCollections[o].__get(a);return void 0===i.schema.relationships[n]?void t.error(\"Cannot add link not specified in schema: \"+n):void 0===i.linkedCollections[o]?void t.error(\"Cannot add link of not existing type: \"+o):e.validate(a)?void 0===r?void t.error(\"Cant find\",o,\"with\",a):void i.addLink(n,r):void t.error(\"Wrong link id, not uuid4: \"+a)}function f(e,n,o){var a,i,r,s=this,l=s.schema.relationships[e];if(void 0===n)return void t.error(\"Can't add non existing object\");if(void 0===l)return void t.error(\"Can't add link not present in schema: \",e,s,o);if(l.polymorphic===!1&&l.model!==n.schema.type)return void t.error(\"This relation is not polymorphic, expected: \"+l.model+\" instead of \"+n.schema.type);if(a=l.type,i=l.reflection,r=s.data.relationships[e].data,\"hasOne\"===a){if(s.data.relationships[e].data.id===n.data.id)return;void 0!==r&&null!==r&&(t.warn(\"Swaping hasOne\",e,\"of\",s.toString()),s.removeLink(e)),s.data.relationships[e].data=n.toLink(),r=n.toLink()}else{var d=!1;if(angular.forEach(s.data.relationships[e].data,function(t){t.id===n.data.id&&(d=!0)}),d===!0)return;s.data.relationships[e].data.push(n.toLink())}o===!0?s.parentCollection.__synchronize(\"addLinkReflection\",s,e,n):(n.addLink(i,s,!0),s.parentCollection.__synchronize(\"addLink\",s,e,n)),s.__setUpdated(),s.__setLinkInternal(r,e,l)}function h(){var t=this;angular.forEach(t.relationships,function(e,n){t.removeLink(n)})}function v(e,n,o){var a,i,r,s=this,l=s.schema.relationships[e],d=!1;return void 0===s.schema.relationships[e]?void t.error(\"Can't remove link not present in schema\"):(a=l.type,r=l.reflection,i=s.data.relationships[e].data,\"hasOne\"===a?(void 0===n||n.data.id===i.id)&&(s.data.relationships[e].data=null,i=null,d=!0,o!==!0&&void 0!==s.relationships[e]&&s.relationships[e].removeLink(r,s,!0)):void 0===n?(s.data.relationships[e].data=[],i=[],d=!0,o!==!0&&angular.forEach(s.relationships[e],function(t){t.removeLink(r,s,!0)})):angular.forEach(i,function(t,e){t.id===n.data.id&&(o!==!0&&n.removeLink(r,s,!0),i.splice(e,1),d=!0)}),void(d===!0&&(s.__setUpdated(),o!==!0?s.parentCollection.__synchronize(\"removeLink\",s,e,n):s.parentCollection.__synchronize(\"removeLinkReflection\",s,e,n),s.__setLinkInternal(i,e,l))))}function g(t){var e=this;e.__setUpdated(),e.__setAttributes(t),e.parentCollection.__synchronize(\"update\",e)}function y(t,e,o){var a=this,i=o.type,r=o.reflection;if(null===t)delete a.relationships[e],a.relationships[e]=void 0;else if(\"hasMany\"===i&&angular.isArray(t)){var s=function(){var e=[];return angular.forEach(t,function(t){var n=a.linkedCollections[t.type].__get(t.id);n.addLink(r,a,!0),e.push(n)}),e};n(a.relationships,e,s)}else if(\"hasOne\"===i&&t.id){var l=function(){var e=a.linkedCollections[t.type].__get(t.id);return e.addLink(r,a,!0),e};n(a.relationships,e,l)}}function m(t,e,n){var o=this,a=n.type,i=n.reflection;if(\"hasMany\"===a&&angular.isArray(t)){var r={};angular.forEach(t,function(t){r[t.id]=t}),angular.forEach(o.relationships[e],function(t){void 0===r[t.data.id]&&t.removeLink(i,o,!0)})}else\"hasOne\"===a&&null!==t&&t.id&&void 0!==o.relationships[e]&&o.relationships[e].data.id!==t.id&&o.relationships[e].removeLink(i,o,!0);o.__setLinkInternal(t,e,n)}function _(t){var e=this;angular.forEach(e.schema.relationships,function(n,o){e.data.relationships[o]=\"hasOne\"===n.type?t[o]||{data:null}:t[o]||{data:[]}}),angular.forEach(e.schema.relationships,function(n,o){void 0!==t[o]&&e.__setLink(t[o].data,o,n)})}function k(t,e){var n=this,o=[];return void 0!==t&&(o=L(n.schema.attributes[e],t,e)),o}function b(e){var n=this,o={};return angular.forEach(n.schema.attributes,function(a,i){var r=n.__validateField(e[i],i);r.length>0&&(o[i]=r,t.warn(\"Erorrs when validating \",e[i],o))}),o}function A(t){var e=this;angular.forEach(e.schema.attributes,function(n,o){t[o]&&(e.data.attributes[o]=t[o])})}function j(t){var e=this,n=angular.copy(t);e.errors.validation=e.__validateData(n),n.relationships=n.relationships||{},n.attributes=n.attributes||{},e.data.id=n.id,e.data.type=n.type,e.__setAttributes(n.attributes),e.__setLinks(n.relationships)}function L(n,o,a){var i=[];if(angular.isArray(n))angular.forEach(n,function(t){i=i.concat(L(t,o,a))});else if(angular.isFunction(n)){var r=n(o);angular.isArray(r)?i.concat(r):t.error(\"Wrong validator type it should return array of errors instead of: \"+r.toString())}else angular.isString(n)?\"text\"===n||\"string\"===n?angular.isString(o)||i.push(a+\" is not a string \"):\"number\"===n||\"integer\"===n?parseInt(o).toString()!==o.toString()&&i.push(a+\" is not a number\"):\"uuid4\"===n?e.validate(o)||i.push(a+\" is not a uuid4\"):\"required\"===n?0===o.toString().length&&i.push(a+\" is empty\"):t.error(\"Wrong validator type: \"+n.toString()):angular.isObject(n)?(void 0!==n.maxlength&&o.length>n.maxlength&&i.push(a+\" is too long max \"+n.maxlength),void 0!==n.minlength&&o.length<n.minlength&&i.push(a+\" is too short min \"+n.minlength),void 0!==n.maxvalue&&parseInt(o)>n.maxvalue&&i.push(a+\" is too big max \"+n.maxvalue),void 0!==n.minvalue&&parseInt(o)<n.minvalue&&i.push(a+\" is too small min \"+n.minvalue)):t.error(\"Wrong validator type: \"+n.toString());return i}return a.prototype.__setData=j,a.prototype.__setLinks=_,a.prototype.__setLink=m,a.prototype.__setAttributes=A,a.prototype.__validateData=b,a.prototype.__validateField=k,a.prototype.__updateAttributes=g,a.prototype.__remove=l,a.prototype.__setUpdated=s,a.prototype.__setLinkInternal=y,a.prototype.refresh=i,a.prototype.remove=d,a.prototype.addLinkById=p,a.prototype.addLink=f,a.prototype.removeLink=v,a.prototype.toLink=c,a.prototype.toPatchData=u,a.prototype.removeAllLinks=h,a.prototype.toJson=r,a}angular.module(\"angular-jsonapi\").factory(\"AngularJsonAPIAbstractData\",t),t.$inject=[\"$log\",\"uuid4\",\"lazyProperty\",\"AngularJsonAPIAbstractDataForm\"]}(),describe(\"AngularJsonAPIAbstractDataForm factory\",function(){}),function(){\"use strict\";function t(t){function e(t){var e=this;e.data={},e.parent=t,e.reset()}function n(){var e=this,n=e.validate();return angular.equals(n,{})===!1?void t.error(\"Errors in form: \",n):void e.parent.__updateAttributes(e.data)}function o(){var t=this;angular.forEach(t.parent.schema.attributes,function(e,n){t.data[n]=t.parent.data.attributes[n]||\"\"}),t.errors={validation:{}}}function a(){var t,e=this;return t=e.parent.__validateData(e.data),e.errors.validation=t,t}function i(t){var e,n=this;return e=n.parent.__validateField(n.data[t],t),n.errors.validation[t]=e,e}function r(e){t.log(\"Synchro Collection \"+this.Model.prototype.schema.type,e)}return e.prototype.save=n,e.prototype.reset=o,e.prototype.validate=a,e.prototype.validateField=i,e.prototype.__synchronize=r,e}angular.module(\"angular-jsonapi\").factory(\"AngularJsonAPIAbstractDataForm\",t),t.$inject=[\"$log\"]}(),describe(\"$jsonapi provider\",function(){beforeEach(module(\"angular-jsonapi\")),it(\"returns valid model\",inject(function(t){expect(t).to.be.ok}))}),function(){\"use strict\";function t(){function t(t,n){function o(t,o){var a=new n(t,o);e[t.type]=a}function a(t){return e[t]}function i(n){return void 0===e[n]&&t.error(\"Can\t add not existing object type: \"+n+\". Use initialize(Model, datas).\"),e[n].dummy.form}function r(n,o){return void 0===e[n]&&t.error(\"Can\t get not existing object type: \"+n+\". Use initialize(Model, datas).\"),e[n].get(o)}function s(n,o){return void 0===e[n]&&t.error(\"Can\t remove not existing object type: \"+n+\". Use initialize(Model, datas).\"),e[n].remove(o)}function l(n){return void 0===e[n]&&t.error(\"Can\t get all of not existing object type: \"+n+\". Use initialize(Model, datas).\"),e[n].all()}return{form:i,get:r,remove:s,all:l,addModel:o,getModel:a}}var e={};this.$get=t,t.$inject=[\"$log\",\"AngularJsonAPICollection\"]}angular.module(\"angular-jsonapi\").provider(\"$jsonapi\",t)}();\n//# sourceMappingURL=angular-jsonapi.min.js.map","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi-rest', ['angular-jsonapi'])\n  .factory('AngularJsonAPISynchronizationRest', AngularJsonAPISynchronizationRestWrapper);\n\n  function AngularJsonAPISynchronizationRestWrapper(AngularJsonAPISynchronization, $q, $http) {\n\n    AngularJsonAPISynchronizationRest.prototype = Object.create(AngularJsonAPISynchronization.prototype);\n    AngularJsonAPISynchronizationRest.prototype.constructor = AngularJsonAPISynchronizationRest;\n\n    return AngularJsonAPISynchronizationRest;\n\n    function AngularJsonAPISynchronizationRest(url) {\n      var _this = this;\n\n      AngularJsonAPISynchronization.call(_this);\n\n      _this.synchronization('remove', remove);\n      _this.synchronization('removeLink', removeLink);\n      _this.synchronization('addLink', addLink);\n      _this.synchronization('update', update);\n      _this.synchronization('add', add);\n      _this.synchronization('all', all);\n      _this.synchronization('get', get);\n      _this.synchronization('refresh', get);\n      _this.after('all', afterAll);\n      _this.after('get', afterGet);\n      _this.after('refresh', afterGet);\n\n      function wrapResp(data, status, headers, config) {\n        return {\n          data: data,\n          status: status,\n          headers: headers,\n          config: config\n        };\n      }\n\n      function afterAll(collection, object, linkSchema, linkedObject, params, results) {\n        var rawData = results[0].value.data.data;\n        var included = results[0].value.data.included;\n\n        if (results[0].success === true && rawData !== undefined) {\n          var indexedData = {};\n          angular.forEach(rawData, function(data) {\n            indexedData[data.id] = data;\n            collection.addOrUpdate(data);\n          });\n\n          angular.forEach(collection.data, function(data) {\n            if (indexedData[data.id] === undefined) {\n              collection.__remove(data.id);\n            }\n          });\n\n          angular.forEach(included, function(object) {\n            collection.allCollections[object.type].addOrUpdate(object);\n          });\n        }\n      }\n\n      function afterGet(collection, object, linkSchema, linkedObject, params, results) {\n        var data;\n        var included;\n\n        if (results[0].success === true) {\n          data = results[0].value.data.data;\n          included = results[0].value.data.included;\n          collection.addOrUpdate(data);\n\n          angular.forEach(included, function(object) {\n            collection.allCollections[object.type].addOrUpdate(object);\n          });\n        } else {\n          object.error = true;\n          object.__remove();\n          collection.__remove(object.data.id);\n        }\n      }\n\n      function all(collection, object, params) {\n        var deferred = $q.defer();\n        var config = {\n          method: 'GET',\n          url: url,\n          params: params || {}\n        };\n\n        $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n\n        return deferred.promise;\n      }\n\n      function get(collection, object, linkSchema, linkedObject, params) {\n        var deferred = $q.defer();\n        var config;\n        var ids;\n\n        if (angular.isArray(object)) {\n          ids = [];\n          angular.forEach(object, function(object) {\n            ids.push(object.data.id);\n          });\n        } else {\n          ids = object.data.id;\n        }\n\n        config = {\n          method: 'GET',\n          url: url + '/' + ids.toString(),\n          params: params || {}\n        };\n\n        $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n\n        return deferred.promise;\n      }\n\n      function remove(collection, object) {\n        var deferred = $q.defer();\n        var config = {\n          method: 'DELETE',\n          url: url + '/' + object.data.id\n        };\n\n        $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n\n        return deferred.promise;\n      }\n\n      function removeLink(collection, object, linkKey, linkedObject) {\n        var deferred = $q.defer();\n        var config;\n\n        if (object.removed === true || linkedObject === undefined) {\n          deferred.resolve();\n        } else {\n          config = {\n            method: 'DELETE',\n            url: url + '/' + object.data.id + '/relationships/' + linkKey,\n            data: {data: linkedObject.toLink()}\n          };\n\n          $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n        }\n\n        return deferred.promise;\n      }\n\n      function addLink(collection, object, linkKey, linkedObject) {\n        var deferred = $q.defer();\n        var config = {\n          method: 'POST',\n          url: url + '/' + object.data.id + '/relationships/' + linkKey,\n          data: {data: linkedObject.toLink()}\n        };\n\n        $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n\n        return deferred.promise;\n\n      }\n\n      function update(collection, object) {\n        var deferred = $q.defer();\n        var config = {\n          method: 'PATCH',\n          url: url + '/' + object.data.id,\n          data: {data: object.toPatchData()}\n        };\n\n        $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n\n        return deferred.promise;\n      }\n\n      function add(collection, object) {\n        var deferred = $q.defer();\n        console.log(object);\n        var config = {\n          method: 'POST',\n          url: url + '/',\n          data: {data: object.toJson()}\n        };\n\n        $http(config).\n          success(function(data, status, headers, config) {\n            deferred.resolve(wrapResp(data, status, headers, config));\n          }).\n          error(function(data, status, headers, config) {\n            deferred.reject(wrapResp(data, status, headers, config));\n          });\n\n        return deferred.promise;\n      }\n    }\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi-local', ['angular-jsonapi'])\n  .factory('AngularJsonAPISynchronizationLocal', AngularJsonAPISynchronizationLocalWrapper);\n\n  function AngularJsonAPISynchronizationLocalWrapper(AngularJsonAPISynchronization, $window) {\n\n    AngularJsonAPISynchronizationLocal.prototype = Object.create(AngularJsonAPISynchronization.prototype);\n    AngularJsonAPISynchronizationLocal.prototype.constructor = AngularJsonAPISynchronizationLocal;\n\n    return AngularJsonAPISynchronizationLocal;\n\n    function AngularJsonAPISynchronizationLocal(prefix) {\n      var _this = this;\n\n      _this.__updateStorage = updateStorage;\n\n      AngularJsonAPISynchronization.call(_this);\n\n      _this.begin('init', init);\n      _this.begin('clear', clear);\n      _this.begin('remove', updateStorage);\n      _this.begin('removeLink', updateStorage);\n      _this.begin('removeLinkReflection', updateStorage);\n      _this.begin('addLink', updateStorage);\n      _this.begin('addLinkReflection', updateStorage);\n      _this.begin('update', updateStorage);\n      _this.begin('add', updateStorage);\n      _this.finish('get', updateStorage);\n      _this.finish('all', updateStorage);\n\n      _this.finish('init', updateStorage);\n      _this.finish('clear', updateStorage);\n      _this.finish('remove', updateStorage);\n      _this.finish('removeLink', updateStorage);\n      _this.finish('removeLinkReflection', updateStorage);\n      _this.finish('addLink', updateStorage);\n      _this.finish('addLinkReflection', updateStorage);\n      _this.finish('update', updateStorage);\n      _this.finish('add', updateStorage);\n      _this.finish('get', updateStorage);\n      _this.finish('all', updateStorage);\n\n      function init(collection) {\n        var datas = $window.localStorage.getItem(prefix + '.' + collection.Model.prototype.schema.type);\n        collection.fromJson(datas);\n      }\n\n      function clear(collection) {\n        $window.localStorage.removeItem(prefix + '.' + collection.Model.prototype.schema.type);\n      }\n\n      function updateStorage(collection) {\n        $window.localStorage.setItem(prefix + '.' + collection.Model.prototype.schema.type, collection.toJson());\n      }\n    }\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .factory('AngularJsonAPISchema', AngularJsonAPISchemaWrapper);\n\n  function AngularJsonAPISchemaWrapper($log) {\n\n    return AngularJsonAPISchema;\n\n    function AngularJsonAPISchema(schema) {\n      var _this = this;\n      var include = [];\n\n      _this.params = {\n        get: {},\n        all: {}\n      };\n\n      angular.forEach(schema.relationships, function(linkSchema, linkName) {\n        var linkSchemaObj = new AngularJsonAPILinkSchema(linkSchema, linkName, schema.type);\n        schema.relationships[linkName] = linkSchemaObj;\n        if (linkSchemaObj.included === true) {\n          include.push(linkName);\n        }\n      });\n\n      angular.extend(_this, schema);\n\n      if (include.length > 0) {\n        _this.params.get.include = include.join(',');\n      }\n    }\n\n    function AngularJsonAPILinkSchema(linkSchema, linkName, type) {\n      var _this = this;\n\n      if (angular.isString(linkSchema)) {\n        _this.model = linkName;\n        _this.type = linkSchema;\n        _this.polymorphic = false;\n        _this.reflection = type;\n      } else {\n        if (linkSchema.type === undefined) {\n          $log.error('Schema of link without a type: ', linkSchema, linkName);\n        }\n\n        _this.model = linkSchema.model || linkName;\n        _this.type = linkSchema.type;\n        _this.polymorphic = linkSchema.polymorphic || false;\n        _this.reflection = linkSchema.reflection || type;\n        _this.included = linkSchema.included || false;\n      }\n    }\n\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .factory('JsonAPIModelFactory', JsonAPIModelFactory);\n\n  function JsonAPIModelFactory(AngularJsonAPIAbstractData, AngularJsonAPISchema, $log) {\n\n    return {\n      model: modelFactory\n    };\n\n    function modelFactory(schemaObj, linkedCollections, parentCollection) {\n      var Model = function(data, updatedAt, dummy) {\n        var _this = this;\n\n        if (data.type !== _this.schema.type) {\n          $log.error('Data type other then declared in schema: ', data.type, ' instead of ', _this.schema.type);\n        }\n\n        AngularJsonAPIAbstractData.call(_this, data, updatedAt, dummy);\n\n        _this.form.parent = _this;\n      };\n\n      Model.prototype = Object.create(AngularJsonAPIAbstractData.prototype);\n      Model.prototype.constructor = Model;\n\n      Model.prototype.schema = schemaObj;\n      Model.prototype.linkedCollections = linkedCollections;\n      Model.prototype.parentCollection = parentCollection;\n\n      angular.forEach(schemaObj.functions, function(metaFunction, metaFunctionName) {\n        Model.prototype[metaFunctionName] = function() {\n          return metaFunction.call(this);\n        };\n      });\n\n      return Model;\n    }\n\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .factory('AngularJsonAPIAbstractData', AngularJsonAPIAbstractDataWrapper);\n\n  function AngularJsonAPIAbstractDataWrapper(\n    $log,\n    uuid4,\n    lazyProperty,\n    AngularJsonAPIAbstractDataForm\n  ) {\n\n    AngularJsonAPIAbstractData.prototype.__setData = __setData;\n    AngularJsonAPIAbstractData.prototype.__setLinks   = __setLinks;\n    AngularJsonAPIAbstractData.prototype.__setLink = __setLink;\n    AngularJsonAPIAbstractData.prototype.__setAttributes = __setAttributes;\n    AngularJsonAPIAbstractData.prototype.__validateData = __validateData;\n    AngularJsonAPIAbstractData.prototype.__validateField = __validateField;\n    AngularJsonAPIAbstractData.prototype.__updateAttributes = __updateAttributes;\n    AngularJsonAPIAbstractData.prototype.__remove = __remove;\n    AngularJsonAPIAbstractData.prototype.__setUpdated = __setUpdated;\n    AngularJsonAPIAbstractData.prototype.__setLinkInternal = __setLinkInternal;\n\n    AngularJsonAPIAbstractData.prototype.refresh = refresh;\n    AngularJsonAPIAbstractData.prototype.remove = remove;\n    AngularJsonAPIAbstractData.prototype.addLinkById = addLinkById;\n    AngularJsonAPIAbstractData.prototype.addLink = addLink;\n    AngularJsonAPIAbstractData.prototype.removeLink = removeLink;\n    AngularJsonAPIAbstractData.prototype.toLink = toLink;\n    AngularJsonAPIAbstractData.prototype.toPatchData = toPatchData;\n    AngularJsonAPIAbstractData.prototype.removeAllLinks = removeAllLinks;\n\n    AngularJsonAPIAbstractData.prototype.toJson = toJson;\n\n    return AngularJsonAPIAbstractData;\n\n    function AngularJsonAPIAbstractData(data, updatedAt, dummy) {\n      var _this = this;\n\n      data.relationships = data.relationships || {};\n\n      _this.removed = false;\n      _this.loadingCount = 0;\n      _this.data = {\n        relationships: {},\n        attributes: {}\n      };\n      _this.relationships = {};\n\n      _this.errors = {\n        validation: {}\n      };\n\n      _this.dummy = dummy || false;\n      _this.error = false;\n\n      _this.__setUpdated(updatedAt);\n      _this.__setData(data, updatedAt);\n\n      _this.form = new AngularJsonAPIAbstractDataForm(_this);\n    }\n\n    function refresh() {\n      var _this = this;\n\n      _this.parentCollection.__synchronize('refresh', _this);\n    }\n\n    function toJson() {\n      var _this = this;\n\n      return {\n        data: _this.data,\n        updatedAt: _this.updatedAt\n      };\n    }\n\n    function __setUpdated(updatedAt) {\n      var _this = this;\n\n      _this.updatedAt = updatedAt || Date.now();\n      _this.parentCollection.updatedAt = _this.updatedAt;\n    }\n\n    function __remove() {\n      var _this = this;\n\n      _this.__setUpdated();\n      _this.removed = true;\n      _this.removeAllLinks();\n    }\n\n    function remove() {\n      var _this = this;\n\n      _this.__remove();\n      _this.parentCollection.remove(_this.data.id);\n    }\n\n    function toLink() {\n      return {type: this.data.type, id: this.data.id};\n    }\n\n    function toPatchData() {\n      var _this = this;\n      var res = {data: {}};\n      angular.forEach(_this.data, function(val, key) {\n        if (key !== 'relationships') {\n          res.data[key] = val;\n        }\n      });\n\n      return res;\n    }\n\n    function addLinkById(linkKey, linkModelName, id) {\n      var _this = this;\n      var linkedObject = _this.linkedCollections[linkModelName].__get(id);\n\n      if (_this.schema.relationships[linkKey] === undefined) {\n        $log.error('Cannot add link not specified in schema: ' + linkKey);\n        return;\n      }\n\n      if (_this.linkedCollections[linkModelName] === undefined) {\n        $log.error('Cannot add link of not existing type: ' + linkModelName);\n        return;\n      }\n\n      if (!uuid4.validate(id)) {\n        $log.error('Wrong link id, not uuid4: ' + id);\n        return;\n      }\n\n      if (linkedObject === undefined) {\n        $log.error('Cant find', linkModelName, 'with', id);\n        return;\n      }\n\n      _this.addLink(\n        linkKey,\n        linkedObject\n      );\n\n    }\n\n    function addLink(linkKey, linkedObject, reflection) {\n      var _this = this;\n      var linkSchema = _this.schema.relationships[linkKey];\n      var linkType;\n      var reflectionKey;\n      var linkAttributes;\n\n      if (linkedObject === undefined) {\n        $log.error('Can\\'t add non existing object');\n        return;\n      }\n\n      if (linkSchema === undefined) {\n        $log.error('Can\\'t add link not present in schema: ', linkKey, _this, reflection);\n        return;\n      }\n\n      if (linkSchema.polymorphic === false && linkSchema.model !== linkedObject.schema.type) {\n        $log.error('This relation is not polymorphic, expected: ' + linkSchema.model + ' instead of ' + linkedObject.schema.type);\n        return;\n      }\n\n      linkType = linkSchema.type;\n      reflectionKey = linkSchema.reflection;\n      linkAttributes = _this.data.relationships[linkKey].data;\n\n      if (linkType === 'hasOne') {\n        if (_this.data.relationships[linkKey].data.id === linkedObject.data.id) {\n          return;\n        }\n\n        if (linkAttributes !== undefined && linkAttributes !== null) {\n          $log.warn('Swaping hasOne', linkKey, 'of', _this.toString());\n          _this.removeLink(linkKey);\n        }\n\n        _this.data.relationships[linkKey].data = linkedObject.toLink();\n        linkAttributes = linkedObject.toLink();\n      } else {\n        var duplicate = false;\n        angular.forEach(_this.data.relationships[linkKey].data, function(link) {\n          if (link.id === linkedObject.data.id) {\n            duplicate = true;\n          }\n        });\n\n        if (duplicate === true) {\n          return;\n        }\n\n        _this.data.relationships[linkKey].data.push(linkedObject.toLink());\n      }\n\n      if (reflection === true) {\n        _this.parentCollection.__synchronize('addLinkReflection', _this, linkKey, linkedObject);\n      } else {\n        linkedObject.addLink(reflectionKey, _this, true);\n        _this.parentCollection.__synchronize('addLink', _this, linkKey, linkedObject);\n      }\n\n      _this.__setUpdated();\n      _this.__setLinkInternal(linkAttributes, linkKey, linkSchema);\n    }\n\n    function removeAllLinks() {\n      var _this = this;\n\n      angular.forEach(_this.relationships, function(link, key) {\n        _this.removeLink(key);\n      });\n    }\n\n    function removeLink(linkKey, linkedObject, reflection) {\n      var _this = this;\n      var linkSchema = _this.schema.relationships[linkKey];\n      var linkType;\n      var linkAttributes;\n      var reflectionKey;\n      var removed = false;\n\n      if (_this.schema.relationships[linkKey] === undefined) {\n        $log.error('Can\\'t remove link not present in schema');\n        return;\n      }\n\n      linkType = linkSchema.type;\n      reflectionKey = linkSchema.reflection;\n      linkAttributes = _this.data.relationships[linkKey].data;\n\n      if (linkType === 'hasOne') {\n        if (linkedObject === undefined || linkedObject.data.id === linkAttributes.id) {\n          _this.data.relationships[linkKey].data = null;\n          linkAttributes = null;\n          removed = true;\n          if (reflection !== true && _this.relationships[linkKey] !== undefined) {\n            _this.relationships[linkKey].removeLink(reflectionKey, _this, true);\n          }\n        }\n      } else {\n        if (linkedObject === undefined) {\n          _this.data.relationships[linkKey].data = [];\n          linkAttributes = [];\n          removed = true;\n          if (reflection !== true) {\n            angular.forEach(_this.relationships[linkKey], function(link) {\n              link.removeLink(reflectionKey, _this, true);\n            });\n          }\n        } else {\n          angular.forEach(linkAttributes, function(link, index) {\n            if (link.id === linkedObject.data.id) {\n              if (reflection !== true) {\n                linkedObject.removeLink(reflectionKey, _this, true);\n              }\n\n              linkAttributes.splice(index, 1);\n              removed = true;\n            }\n          });\n        }\n      }\n\n      if (removed === true) {\n        _this.__setUpdated();\n\n        if (reflection !== true) {\n          _this.parentCollection.__synchronize('removeLink', _this, linkKey, linkedObject);\n        } else {\n          _this.parentCollection.__synchronize('removeLinkReflection',  _this, linkKey, linkedObject);\n        }\n\n        _this.__setLinkInternal(linkAttributes, linkKey, linkSchema);\n      }\n    }\n\n    function __updateAttributes(validatedAttributes) {\n      var _this = this;\n\n      _this.__setUpdated();\n      _this.__setAttributes(validatedAttributes);\n      _this.parentCollection.__synchronize('update', _this);\n    }\n\n    function __setLinkInternal(linkAttributes, linkKey, linkSchema) {\n      var _this = this;\n      var linkType = linkSchema.type;\n      var reflectionKey = linkSchema.reflection;\n\n      if (linkAttributes === null) {\n        delete _this.relationships[linkKey];\n        _this.relationships[linkKey] = undefined;\n      } else if (linkType === 'hasMany' && angular.isArray(linkAttributes)) {\n        var getAll = function() {\n          var result = [];\n          angular.forEach(linkAttributes, function(link) {\n            var linkedObject = _this.linkedCollections[link.type].__get(link.id);\n            linkedObject.addLink(reflectionKey, _this, true);\n\n            result.push(linkedObject);\n          });\n\n          return result;\n        };\n\n        lazyProperty(_this.relationships, linkKey, getAll);\n      } else if (linkType === 'hasOne' && linkAttributes.id) {\n\n        var getSingle = function() {\n          var linkedObject = _this.linkedCollections[linkAttributes.type].__get(linkAttributes.id);\n          linkedObject.addLink(reflectionKey, _this, true);\n\n          return linkedObject;\n        };\n\n        lazyProperty(_this.relationships, linkKey, getSingle);\n      }\n    }\n\n    function __setLink(linkAttributes, linkKey, linkSchema) {\n      var _this = this;\n      var linkType = linkSchema.type;\n      var reflectionKey = linkSchema.reflection;\n\n      if (linkType === 'hasMany' && angular.isArray(linkAttributes)) {\n        var indexedLinks = {};\n        angular.forEach(linkAttributes, function(link) {\n          indexedLinks[link.id] = link;\n        });\n\n        angular.forEach(_this.relationships[linkKey], function(link) {\n          if (indexedLinks[link.data.id] === undefined) {\n            link.removeLink(reflectionKey, _this, true);\n          }\n        });\n      } else if (linkType === 'hasOne' && linkAttributes !== null && linkAttributes.id) {\n        if (_this.relationships[linkKey] !== undefined && _this.relationships[linkKey].data.id !== linkAttributes.id) {\n          _this.relationships[linkKey].removeLink(reflectionKey, _this, true);\n        }\n      }\n\n      _this.__setLinkInternal(linkAttributes, linkKey, linkSchema);\n    }\n\n    function __setLinks(relationships) {\n      var _this = this;\n      angular.forEach(_this.schema.relationships, function(linkSchema, linkName) {\n        if (linkSchema.type === 'hasOne') {\n          _this.data.relationships[linkName] = relationships[linkName] || {data: null};\n        } else {\n          _this.data.relationships[linkName] = relationships[linkName] || {data: []};\n        }\n      });\n\n      angular.forEach(_this.schema.relationships, function(linkSchema, linkKey) {\n        if (relationships[linkKey] !== undefined) {\n          _this.__setLink(relationships[linkKey].data, linkKey, linkSchema);\n        }\n      });\n    }\n\n    function __validateField(data, key) {\n      var _this = this;\n      var error = [];\n\n      if (data !== undefined) {\n        error = __validate(_this.schema.attributes[key], data, key);\n      }\n\n      return error;\n    }\n\n    function __validateData(data) {\n      var _this = this;\n      var errors = {};\n\n      angular.forEach(_this.schema.attributes, function(validator, key) {\n        var error = _this.__validateField(data[key], key);\n        if (error.length > 0) {\n          errors[key] = error;\n          $log.warn('Erorrs when validating ', data[key], errors);\n        }\n      });\n\n      return errors;\n    }\n\n    function __setAttributes(attributes) {\n      var _this = this;\n\n      angular.forEach(_this.schema.attributes, function(validator, attributeName) {\n        if (attributes[attributeName]) {\n          _this.data.attributes[attributeName] = attributes[attributeName];\n        }\n      });\n    }\n\n    function __setData(data) {\n      var _this = this;\n      var safeData = angular.copy(data);\n\n      _this.errors.validation = _this.__validateData(safeData);\n\n      safeData.relationships = safeData.relationships || {};\n      safeData.attributes = safeData.attributes || {};\n\n      _this.data.id = safeData.id;\n      _this.data.type = safeData.type;\n\n      _this.__setAttributes(safeData.attributes);\n      _this.__setLinks(safeData.relationships);\n    }\n\n    function __validate(validator, attributeValue, attributeName) {\n      var errors = [];\n      if (angular.isArray(validator)) {\n        angular.forEach(validator, function(element) {\n          errors = errors.concat(__validate(element, attributeValue, attributeName));\n        });\n      } else if (angular.isFunction(validator)) {\n        var err = validator(attributeValue);\n        if (angular.isArray(err)) {\n          errors.concat(err);\n        } else {\n          $log.error(\n            'Wrong validator type it should return array of errors instead of: ' +\n              err.toString()\n          );\n        }\n      } else if (angular.isString(validator)) {\n        if (validator === 'text' || validator === 'string') {\n          if (!angular.isString(attributeValue)) {\n            errors.push(attributeName + ' is not a string ');\n          }\n        } else if (validator === 'number' || validator === 'integer') {\n          if (parseInt(attributeValue).toString() !== attributeValue.toString()) {\n            errors.push(attributeName + ' is not a number');\n          }\n        } else if (validator === 'uuid4') {\n          if (!uuid4.validate(attributeValue)) {\n            errors.push(attributeName + ' is not a uuid4');\n          }\n        } else if (validator === 'required') {\n          if (attributeValue.toString().length === 0) {\n            errors.push(attributeName + ' is empty');\n          }\n        } else {\n          $log.error('Wrong validator type: ' + validator.toString());\n        }\n      } else if (angular.isObject(validator)) {\n        if (validator.maxlength !== undefined && attributeValue.length > validator.maxlength) {\n          errors.push(attributeName + ' is too long max ' + validator.maxlength);\n        }\n\n        if (validator.minlength !== undefined && attributeValue.length < validator.minlength) {\n          errors.push(attributeName + ' is too short min ' + validator.minlength);\n        }\n\n        if (validator.maxvalue !== undefined && parseInt(attributeValue) > validator.maxvalue) {\n          errors.push(attributeName + ' is too big max ' + validator.maxvalue);\n        }\n\n        if (validator.minvalue !== undefined && parseInt(attributeValue) < validator.minvalue) {\n          errors.push(attributeName + ' is too small min ' + validator.minvalue);\n        }\n      } else {\n        $log.error('Wrong validator type: ' + validator.toString());\n      }\n\n      return errors;\n    }\n\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .factory('AngularJsonAPIAbstractDataForm', AngularJsonAPIAbstractDataFormWrapper);\n\n  function AngularJsonAPIAbstractDataFormWrapper($log) {\n\n    AngularJsonAPIAbstractDataForm.prototype.save = save;\n    AngularJsonAPIAbstractDataForm.prototype.reset = reset;\n    AngularJsonAPIAbstractDataForm.prototype.validate = validate;\n    AngularJsonAPIAbstractDataForm.prototype.validateField = validateField;\n\n    AngularJsonAPIAbstractDataForm.prototype.__synchronize = __synchronize;\n\n    return AngularJsonAPIAbstractDataForm;\n\n    function AngularJsonAPIAbstractDataForm(parent) {\n      var _this = this;\n\n      _this.data = {};\n      _this.parent = parent;\n      _this.reset();\n    }\n\n    function save() {\n      var _this = this;\n      var errors = _this.validate();\n\n      if (angular.equals(errors, {}) === false) {\n        $log.error('Errors in form: ', errors);\n        return;\n      }\n\n      _this.parent.__updateAttributes(_this.data);\n    }\n\n    function reset() {\n      var _this = this;\n\n      angular.forEach(_this.parent.schema.attributes, function(data, key) {\n        _this.data[key] = _this.parent.data.attributes[key] || '';\n      });\n\n      _this.errors = {\n        validation: {}\n      };\n    }\n\n    function validate() {\n      var _this = this;\n      var errors;\n\n      errors = _this.parent.__validateData(_this.data);\n\n      _this.errors.validation = errors;\n\n      return errors;\n    }\n\n    function validateField(key) {\n      var _this = this;\n      var errors;\n      errors = _this.parent.__validateField(\n        _this.data[key],\n        key\n      );\n\n      _this.errors.validation[key] = errors;\n\n      return errors;\n    }\n\n    function __synchronize(key) {\n      $log.log('Synchro Collection ' + this.Model.prototype.schema.type, key);\n    }\n\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .factory('AngularJsonAPICollection', AngularJsonAPICollectionWrapper);\n\n  function AngularJsonAPICollectionWrapper(\n    $log,\n    uuid4,\n    JsonAPIModelFactory,\n    AngularJsonAPISchema\n  ) {\n    AngularJsonAPICollection.prototype.allCollections = {};\n\n    AngularJsonAPICollection.prototype.__synchronize = __synchronize;\n    AngularJsonAPICollection.prototype.__get = __get;\n    AngularJsonAPICollection.prototype.__remove = __remove;\n\n    AngularJsonAPICollection.prototype.get = get;\n    AngularJsonAPICollection.prototype.all = all;\n    AngularJsonAPICollection.prototype.remove = remove;\n    AngularJsonAPICollection.prototype.clear = clear;\n    AngularJsonAPICollection.prototype.fromJson = fromJson;\n    AngularJsonAPICollection.prototype.toJson = toJson;\n    AngularJsonAPICollection.prototype.addOrUpdate = addOrUpdate;\n\n    return AngularJsonAPICollection;\n\n    function AngularJsonAPICollection(schema, synchronization) {\n      var _this = this;\n\n      var schemaObj = new AngularJsonAPISchema(schema);\n\n      _this.Model = JsonAPIModelFactory.model(\n        schemaObj,\n        _this.allCollections,\n        _this\n      );\n\n      _this.synchronization = synchronization;\n\n      _this.loadingCount = 0;\n      _this.data = {};\n      _this.removed = {};\n      _this.schema = schemaObj;\n\n      _this.dummy = new _this.Model({type: schema.type}, undefined, true);\n      _this.dummy.form.save = __saveDummy.bind(_this.dummy);\n      _this.allCollections[schema.type] = _this;\n\n      _this.__synchronize('init');\n    }\n\n    function fromJson(json) {\n      var _this = this;\n      var collection = angular.fromJson(json);\n\n      if (collection !== null && collection.data !== undefined) {\n        _this.updatedAt = collection.updatedAt;\n\n        angular.forEach(collection.data, function(objectData) {\n          var data = objectData.data;\n          _this.addOrUpdate(data, objectData.updatedAt);\n        });\n      }\n    }\n\n    function toJson() {\n      var _this = this;\n      var json = {\n        data: {},\n        updatedAt: _this.updatedAt\n      };\n\n      angular.forEach(_this.data, function(object, key) {\n        json.data[key] = object.toJson();\n      });\n\n      return angular.toJson(json);\n    }\n\n    function addOrUpdate(validatedData, updatedAt) {\n      var _this = this;\n      if (validatedData.id === undefined) {\n        $log.error('Can\\'t add data without id!', validatedData);\n        return;\n      }\n\n      if (_this.data[validatedData.id] === undefined) {\n        _this.data[validatedData.id] = new this.Model(validatedData, updatedAt);\n      } else {\n        _this.data[validatedData.id].__setData(validatedData, updatedAt);\n        _this.data[validatedData.id].__setLinks(validatedData.relationships);\n      }\n\n      _this.data[validatedData.id].__setUpdated(updatedAt);\n\n      return _this.data[validatedData.id];\n    }\n\n    function __get(id) {\n      var _this = this;\n\n      if (_this.data[id] === undefined) {\n        _this.data[id] = new _this.Model({id: id, type: _this.Model.prototype.schema.type}, undefined, true);\n      }\n\n      return _this.data[id];\n    }\n\n    function get(id) {\n      var _this = this;\n      var result;\n\n      if (angular.isArray(id)) {\n        result = [];\n        angular.forEach(id, function(id) {\n          result.push(_this.__get(id));\n        });\n      } else {\n        result = _this.__get(id);\n      }\n\n      _this.__synchronize('get', result, undefined, undefined, _this.schema.params.get);\n\n      return result;\n    }\n\n    function all() {\n      var _this = this;\n\n      _this.__synchronize('all', undefined, undefined, undefined, _this.schema.params.all);\n\n      return _this.data;\n    }\n\n    function clear() {\n      var _this = this;\n      _this.updatedAt = Date.now();\n      _this.data = {};\n\n      _this.__synchronize('clear');\n    }\n\n    function __remove(id) {\n      var _this = this;\n      var object = _this.data[id];\n\n      _this.removed[id] = object;\n      _this.updatedAt = Date.now();\n\n      delete _this.data[id];\n    }\n\n    function remove(id) {\n      var _this = this;\n      var object = _this.data[id];\n\n      if (object !== undefined) {\n        _this.__remove(id);\n        object.__remove(id);\n      } else {\n        $log.error('Object with this id does not exist');\n      }\n\n      _this.__synchronize('remove', object);\n    }\n\n    function __saveDummy() {\n      var _this = this;\n      var errors = _this.form.validate();\n      var newModel;\n\n      if (angular.equals(errors, {})) {\n        var data = angular.copy(_this.form.data);\n        if (data.id === undefined) {\n          data.id = uuid4.generate();\n        } else if (!uuid4.validate(data.id)) {\n          $log.error('Wrong id of dummy data!');\n          return;\n        }\n\n        data.relationships = {};\n\n        data.type = _this.schema.type;\n        newModel = _this.parentCollection.addOrUpdate(data);\n        _this.form.reset();\n        _this.parentCollection.__synchronize('add', _this);\n      }\n    }\n\n    function __synchronize(action, object, linkKey, linkedObject, params) {\n      var _this = this;\n\n      $log.log('Synchro Collection', this.Model.prototype.schema.type, {action: action, object: object, linkKey: linkKey, linkedObject: linkedObject, params: params});\n\n      _this.synchronization.synchronize(action, _this, object, linkKey, linkedObject, params);\n    }\n  }\n})();\n","(function() {\n  'use strict';\n\n  angular.module('angular-jsonapi')\n  .provider('$jsonapi', jsonapiProvider);\n\n  function jsonapiProvider() {\n    var memory = {};\n    this.$get = jsonapiFactory;\n\n    function jsonapiFactory($log, AngularJsonAPICollection) {\n      return {\n        form: form,\n        get: get,\n        remove: remove,\n        all: all,\n        addModel: addModel,\n        getModel: getModel\n      };\n\n      function addModel(schema, synchronization) {\n        var collection = new AngularJsonAPICollection(schema, synchronization);\n\n        memory[schema.type] = collection;\n      }\n\n      function getModel(type) {\n        return memory[type];\n      }\n\n      function form(type) {\n        if (memory[type] === undefined) {\n          $log.error('Can\\t add not existing object type: ' + type + '. Use initialize(Model, datas).');\n        }\n\n        return memory[type].dummy.form;\n      }\n\n      function get(type, id) {\n        if (memory[type] === undefined) {\n          $log.error('Can\\t get not existing object type: ' + type + '. Use initialize(Model, datas).');\n        }\n\n        return memory[type].get(id);\n      }\n\n      function remove(type, id) {\n        if (memory[type] === undefined) {\n          $log.error('Can\\t remove not existing object type: ' + type + '. Use initialize(Model, datas).');\n        }\n\n        return memory[type].remove(id);\n      }\n\n      function all(type) {\n        if (memory[type] === undefined) {\n          $log.error('Can\\t get all of not existing object type: ' + type + '. Use initialize(Model, datas).');\n        }\n\n        return memory[type].all();\n      }\n    }\n  }\n\n})();\n\n"],"sourceRoot":"/source/"}