!function(){"use strict";angular.module("angular-jsonapi",["uuid4"]).constant("pluralize",pluralize)}(),function(){"use strict";angular.module("angular-jsonapi").constant("lazyProperty",function(t,e,r){var o,n;Object.defineProperty(t,e,{get:function(){return n||(n=!0,o=r.call(t)),o},enumerable:!0,configurable:!0})})}(),function(){"use strict";angular.module("angular-jsonapi").config(["$provide",function(t){t.decorator("$q",["$delegate",function(t){var e=t;return e.allSettled=e.allSettled||function(t){function r(t){return e.when(t).then(function(t){return{success:!0,value:t}},function(t){return{success:!1,reason:t}})}var o=angular.isArray(t)?[]:{};return angular.forEach(t,function(t,e){o.hasOwnProperty(e)||(o[e]=r(t))}),e.all(o)},e}])}])}(),function(){"use strict";function t(t){function e(){var t=this,e=["add","init","get","all","clear","remove","removeLink","removeLinkReflection","addLink","addLinkReflection","update","refresh"];t.state={},t.beginHooks={},t.beforeHooks={},t.synchronizationHooks={},t.afterHooks={},t.finishHooks={},t.options={},angular.forEach(e,function(e){t.beginHooks[e]=[],t.beforeHooks[e]=[],t.synchronizationHooks[e]=[],t.afterHooks[e]=[],t.finishHooks[e]=[],t.state[e]={loading:!1,success:!0}})}function r(t){function e(e){angular.forEach(t[e],function(t,o){r[e][o]=r[e][o].concat(t)})}var r=this;e("beginHooks"),e("beforeHooks"),e("synchronizationHooks"),e("afterHooks"),e("finishHooks"),angular.extend(r.options,t.options)}function o(t,e){var r=this;r.beginHooks[t].push(e)}function n(t,e){var r=this;r.finishHooks[t].push(e)}function a(t,e){var r=this;r.beforeHooks[t].push(e)}function i(t,e){var r=this;r.afterHooks[t].push(e)}function s(t,e){var r=this;r.synchronizationHooks[t].push(e)}function l(e,r,o,n,a,i){var s=this,l=[];s.state[e].loading=!0,void 0!==o&&(o.loadingCount+=1),void 0!==r&&(r.loadingCount+=1),angular.forEach(s.beginHooks[e],function(t){t.call(s,r,o,n,a,i)}),angular.forEach(s.beforeHooks[e],function(t){t.call(s,r,o,n,a,i)}),angular.forEach(s.synchronizationHooks[e],function(t){l.push(t.call(s,r,o,n,a,i))}),t.allSettled(l).then(function(t){s.state[e].success=!0,angular.forEach(t,function(t){t.success===!1&&(s.state[e].success=!1)}),angular.forEach(s.afterHooks[e],function(e){e.call(s,r,o,n,a,i,t)}),angular.forEach(s.finishHooks[e],function(t){t.call(s,r,o,n,a,i)}),s.state[e].loading=!1,void 0!==o&&(o.loadingCount-=1),void 0!==r&&(r.loadingCount-=1)})}return e.prototype.before=a,e.prototype.after=i,e.prototype.begin=o,e.prototype.finish=n,e.prototype.synchronization=s,e.prototype.synchronize=l,e.prototype.extend=r,e}angular.module("angular-jsonapi").factory("AngularJsonAPISynchronization",t),t.$inject=["$q"]}(),function(){"use strict";function t(t,e,r){function o(o){function n(t,e,r,o){return{data:t,status:e,headers:r,config:o}}function a(t,e,r,o,n,a){var i,s,l;a[0].success===!0&&(i=a[0].value.data.data,s=a[0].value.data.included,l={},angular.forEach(i,function(e){l[e.id]=e,t.addOrUpdate(e)}),angular.forEach(t.data,function(e){void 0===l[e.id]&&t.__remove(e.id)}),angular.forEach(s,function(e){t.allCollections[e.type].addOrUpdate(e)}))}function i(t,e,r,o,n,a){var i,s;a[0].success===!0&&(i=a[0].value.data.data,s=a[0].value.data.included,t.addOrUpdate(i),angular.forEach(s,function(e){t.allCollections[e.type].addOrUpdate(e)}))}function s(t,a,i){var s=e.defer(),l={method:"GET",url:o,params:i||{}};return t.errors.rest=t.errors.rest||{},r(l).success(function(e,r,o,a){t.errors.rest.all=void 0,s.resolve(n(e,r,o,a))}).error(function(e,r,o,a){t.errors.rest.all=e,s.reject(n(e,r,o,a))}),s.promise}function l(t,a,i,s,l){var u,d,c=e.defer();return angular.isArray(a)?(d=[],angular.forEach(a,function(t){d.push(t.data.id)})):d=a.data.id,u={method:"GET",url:o+"/"+d.toString(),params:l||{}},a.errors.rest=a.errors.rest||{},r(u).success(function(t,e,r,o){a.errors.rest.get=void 0,c.resolve(n(t,e,r,o))}).error(function(t,e,r,o){a.errors.rest.get=t,c.reject(n(t,e,r,o))}),c.promise}function u(t,a){var i=e.defer(),s={method:"DELETE",url:o+"/"+a.data.id};return a.errors.rest=a.errors.rest||{},r(s).success(function(t,e,r,o){a.errors.rest.remove=void 0,i.resolve(n(t,e,r,o))}).error(function(t,e,r,o){a.errors.rest.remove=t,i.reject(n(t,e,r,o))}),i.promise}function d(t,a,i,s){var l,u=e.defer();return a.errors.rest=a.errors.rest||{},a.removed===!0||void 0===s?u.resolve():(l={method:"DELETE",url:o+"/"+a.data.id+"/relationships/"+i,data:{data:s.toLink()}},r(l).success(function(t,e,r,o){a.errors.rest.removeLink=void 0,u.resolve(n(t,e,r,o))}).error(function(t,e,r,o){a.errors.rest.removeLink=t,u.reject(n(t,e,r,o))})),u.promise}function c(t,a,i,s){var l=e.defer(),u={method:"POST",url:o+"/"+a.data.id+"/relationships/"+i,data:{data:s.toLink()}};return a.errors.rest=a.errors.rest||{},r(u).success(function(t,e,r,o){a.errors.rest.addLink=void 0,l.resolve(n(t,e,r,o))}).error(function(t,e,r,o){a.errors.rest.addLink=t,l.reject(n(t,e,r,o))}),l.promise}function p(t,a){var i=e.defer(),s={method:"PATCH",url:o+"/"+a.data.id,data:{data:a.toPatchData()}};return a.errors.rest=a.errors.rest||{},r(s).success(function(t,e,r,o){a.errors.rest.update=void 0,i.resolve(n(t,e,r,o))}).error(function(t,e,r,o){a.errors.rest.update=t,i.reject(n(t,e,r,o))}),i.promise}function f(t,a){var i=e.defer(),s={method:"POST",url:o+"/",data:{data:a.toJson()}};return a.errors.rest=a.errors.rest||{},r(s).success(function(t,e,r,o){a.errors.rest.add=void 0,i.resolve(n(t,e,r,o))}).error(function(t,e,r,o){a.errors.rest.add=t,i.reject(n(t,e,r,o))}),i.promise}var h=this;t.call(h),h.synchronization("remove",u),h.synchronization("removeLink",d),h.synchronization("addLink",c),h.synchronization("update",p),h.synchronization("add",f),h.synchronization("all",s),h.synchronization("get",l),h.synchronization("refresh",l),h.after("all",a),h.after("get",i),h.after("refresh",i)}return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o}angular.module("angular-jsonapi-rest",["angular-jsonapi"]).factory("AngularJsonAPISynchronizationRest",t),t.$inject=["AngularJsonAPISynchronization","$q","$http"]}(),function(){"use strict";function t(t,e){function r(r){function o(t){var o=e.localStorage.getItem(r+"."+t.Model.prototype.schema.type);t.fromJson(o)}function n(t){e.localStorage.removeItem(r+"."+t.Model.prototype.schema.type)}function a(t){e.localStorage.setItem(r+"."+t.Model.prototype.schema.type,t.toJson())}var i=this;i.__updateStorage=a,t.call(i),i.begin("init",o),i.begin("clear",n),i.begin("remove",a),i.begin("removeLink",a),i.begin("removeLinkReflection",a),i.begin("addLink",a),i.begin("addLinkReflection",a),i.begin("update",a),i.begin("add",a),i.finish("get",a),i.finish("all",a),i.finish("init",a),i.finish("clear",a),i.finish("remove",a),i.finish("removeLink",a),i.finish("removeLinkReflection",a),i.finish("addLink",a),i.finish("addLinkReflection",a),i.finish("update",a),i.finish("add",a),i.finish("get",a),i.finish("all",a)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r}angular.module("angular-jsonapi-local",["angular-jsonapi"]).factory("AngularJsonAPISynchronizationLocal",t),t.$inject=["AngularJsonAPISynchronization","$window"]}(),function(){"use strict";function t(t,e,r,o){function n(t,e){var n=this,a=new o(t);n.Model=r.model(a,n.allCollections,n),n.synchronization=e,n.loadingCount=0,n.data={},n.removed={},n.schema=a,n.dummy=new n.Model({type:t.type},void 0,!0),n.dummy.form.save=v.bind(n.dummy),n.allCollections[t.type]=n,n.__synchronize("init"),n.errors={}}function a(){var t=this,e=!1;return angular.forEach(t.errors,function(t){void 0!==t&&(e=!0)}),e}function i(t){var e=this,r=angular.fromJson(t);null!==r&&void 0!==r.data&&(e.updatedAt=r.updatedAt,angular.forEach(r.data,function(t){var r=t.data;e.addOrUpdate(r,t.updatedAt)}))}function s(){var t=this,e={data:{},updatedAt:t.updatedAt};return angular.forEach(t.data,function(t,r){e.data[r]=t.toJson()}),angular.toJson(e)}function l(e,r){var o=this;return void 0===e.id?void t.error("Can't add data without id!",e):(void 0===o.data[e.id]?o.data[e.id]=new this.Model(e,r):(o.data[e.id].__setData(e,r),o.data[e.id].__setLinks(e.relationships)),o.data[e.id].__setUpdated(r),o.data[e.id])}function u(t){var e=this;return void 0===e.data[t]&&(e.data[t]=new e.Model({id:t,type:e.Model.prototype.schema.type},void 0,!0)),e.data[t]}function d(t){var e,r=this;return angular.isArray(t)?(e=[],angular.forEach(t,function(t){e.push(r.__get(t))})):e=r.__get(t),r.__synchronize("get",e,void 0,void 0,r.schema.params.get),e}function c(){var t=this;return t.__synchronize("all",void 0,void 0,void 0,t.schema.params.all),t}function p(){var t=this;t.updatedAt=Date.now(),t.data={},t.__synchronize("clear")}function f(t){var e=this,r=e.data[t];e.removed[t]=r,e.updatedAt=Date.now(),delete e.data[t]}function h(e){var r=this,o=r.data[e];void 0!==o?(r.__remove(e),o.__remove(e)):t.error("Object with this id does not exist"),r.__synchronize("remove",o)}function v(){var r,o=this,n=o.form.validate();if(angular.equals(n,{})){var a=angular.copy(o.form.data);if(void 0===a.id)a.id=e.generate();else if(!e.validate(a.id))return void t.error("Wrong id of dummy data!");a.relationships={},a.type=o.schema.type,r=o.parentCollection.addOrUpdate(a),o.form.reset(),o.parentCollection.__synchronize("add",o)}}function g(e,r,o,n,a){var i=this;t.log("Synchro Collection",this.Model.prototype.schema.type,{action:e,object:r,linkKey:o,linkedObject:n,params:a}),i.synchronization.synchronize(e,i,r,o,n,a)}return n.prototype.allCollections={},n.prototype.__synchronize=g,n.prototype.__get=u,n.prototype.__remove=f,n.prototype.get=d,n.prototype.all=c,n.prototype.remove=h,n.prototype.clear=p,n.prototype.fromJson=i,n.prototype.toJson=s,n.prototype.addOrUpdate=l,n.prototype.hasErrors=a,n}angular.module("angular-jsonapi").factory("AngularJsonAPICollection",t),t.$inject=["$log","uuid4","JsonAPIModelFactory","AngularJsonAPISchema"]}(),function(){"use strict";function t(t,e){function r(t){var e=this,r=[];e.params={get:{},all:{}},angular.forEach(t.relationships,function(e,n){var a=new o(e,n,t.type);t.relationships[n]=a,a.included===!0&&r.push(n)}),angular.extend(e,t),r.length>0&&(e.params.get.include=r.join(","))}function o(r,o,n){var a=this;angular.isString(r)?(a.model=e.plural(o),a.type=r,a.polymorphic=!1,a.reflection=n):(void 0===r.type&&t.error("Schema of link without a type: ",r,o),a.model=r.model||e.plural(o),a.type=r.type,a.polymorphic=r.polymorphic||!1,a.reflection=r.reflection||n,a.included=r.included||!1)}return r}angular.module("angular-jsonapi").factory("AngularJsonAPISchema",t),t.$inject=["$log","pluralize"]}(),function(){"use strict";function t(t,e,r){function o(e,o,n){var a=function(e,o,n){var a=this;e.type!==a.schema.type&&r.error("Data type other then declared in schema: ",e.type," instead of ",a.schema.type),t.call(a,e,o,n),a.form.parent=a};return a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.prototype.schema=e,a.prototype.linkedCollections=o,a.prototype.parentCollection=n,angular.forEach(e.functions,function(t,e){a.prototype[e]=function(){return t.call(this)}}),a}return{model:o}}angular.module("angular-jsonapi").factory("JsonAPIModelFactory",t),t.$inject=["AngularJsonAPIAbstractData","AngularJsonAPISchema","$log"]}(),function(){"use strict";function t(t,e,r,o){function n(t,e,r){var n=this;t.relationships=t.relationships||{},n.removed=!1,n.loadingCount=0,n.data={relationships:{},attributes:{}},n.relationships={},n.errors={validation:{}},n.dummy=r||!1,n.__setUpdated(e),n.__setData(t,e),n.form=new o(n)}function a(){var t=this;t.parentCollection.__synchronize("refresh",t)}function i(){var t=this,e=!1;return angular.forEach(t.errors,function(t){void 0!==t&&(e=!0)}),e}function s(){var t=this;return{data:t.data,updatedAt:t.updatedAt}}function l(t){var e=this;e.updatedAt=t||Date.now(),e.parentCollection.updatedAt=e.updatedAt}function u(){var t=this;t.__setUpdated(),t.removed=!0,t.removeAllLinks()}function d(){var t=this;t.__remove(),t.parentCollection.remove(t.data.id)}function c(){return{type:this.data.type,id:this.data.id}}function p(){var t=this,e={data:{}};return angular.forEach(t.data,function(t,r){"relationships"!==r&&(e.data[r]=t)}),e}function f(r,o,n){var a=this,i=a.linkedCollections[o].__get(n);return void 0===a.schema.relationships[r]?void t.error("Cannot add link not specified in schema: "+r):void 0===a.linkedCollections[o]?void t.error("Cannot add link of not existing type: "+o):e.validate(n)?void 0===i?void t.error("Cant find",o,"with",n):void a.addLink(r,i):void t.error("Wrong link id, not uuid4: "+n)}function h(e,r,o){var n,a,i,s=this,l=s.schema.relationships[e];if(void 0===r)return void t.error("Can't add non existing object");if(void 0===l)return void t.error("Can't add link not present in schema: ",e,s,o);if(l.polymorphic===!1&&l.model!==r.schema.type)return void t.error("This relation is not polymorphic, expected: "+l.model+" instead of "+r.schema.type);if(n=l.type,a=l.reflection,"hasOne"===n){if(i=s.data.relationships[e].data,void 0!==i&&null!==i&&i.id===r.data.id)return;void 0!==i&&null!==i&&(t.warn("Swaping hasOne",e,"of",s.toString()),s.removeLink(e)),i=r.toLink()}else{i=s.data.relationships[e].data||[];var u=!1;if(angular.forEach(i,function(t){t.id===r.data.id&&(u=!0)}),u===!0)return;i.push(r.toLink())}o===!0?s.parentCollection.__synchronize("addLinkReflection",s,e,r):(r.addLink(a,s,!0),s.parentCollection.__synchronize("addLink",s,e,r)),s.__setUpdated(),s.__setLinkInternal(i,e,l)}function v(){var t=this;angular.forEach(t.relationships,function(e,r){t.removeLink(r)})}function g(e,r,o){var n,a,i,s=this,l=s.schema.relationships[e],u=!1;return void 0===s.schema.relationships[e]?void t.error("Can't remove link not present in schema"):(n=l.type,i=l.reflection,a=s.data.relationships[e].data,"hasOne"===n?void 0!==r&&r.data.id===a.id&&(s.data.relationships[e].data=null,a=null,u=!0,o!==!0&&void 0!==s.relationships[e]&&s.relationships[e].removeLink(i,s,!0)):void 0===r?(s.data.relationships[e].data=[],a=[],u=!0,o!==!0&&angular.forEach(s.relationships[e],function(t){t.removeLink(i,s,!0)})):angular.forEach(a,function(t,e){t.id===r.data.id&&(o!==!0&&r.removeLink(i,s,!0),a.splice(e,1),u=!0)}),void(u===!0&&(s.__setUpdated(),o!==!0?s.parentCollection.__synchronize("removeLink",s,e,r):s.parentCollection.__synchronize("removeLinkReflection",s,e,r),s.__setLinkInternal(a,e,l))))}function y(t){var e=this;e.__setUpdated(),e.__setAttributes(t),e.parentCollection.__synchronize("update",e)}function m(e,o,n){var a=this,i=n.type,s=n.reflection;if(null===e)delete a.relationships[o],a.relationships[o]=void 0;else if("hasMany"===i&&angular.isArray(e)){var l=function(){var r=[];return angular.forEach(e,function(o){var n=a.linkedCollections[o.type];if(void 0===n)return void t.error("No angular-jsonapi schema for",e.type);var i=n.__get(o.id);i.addLink(s,a,!0),r.push(i)}),r};r(a.relationships,o,l)}else if("hasOne"===i&&null!==e){var u=function(){var r=a.linkedCollections[e.type];if(void 0===r)return void t.error("No angular-jsonapi schema for",e.type);var o=r.__get(e.id);return o.addLink(s,a,!0),o};r(a.relationships,o,u)}}function _(t,e,r){var o=this,n=r.type,a=r.reflection;if("hasMany"===n&&angular.isArray(t)){var i={};angular.forEach(t,function(t){i[t.id]=t}),angular.forEach(o.relationships[e],function(t){void 0===i[t.data.id]&&t.removeLink(a,o,!0)})}else"hasOne"===n&&null!==t&&void 0!==o.relationships[e]&&o.relationships[e].data.id!==t.id&&o.relationships[e].removeLink(a,o,!0);o.__setLinkInternal(t,e,r)}function k(t){var e=this;angular.forEach(e.schema.relationships,function(r,o){e.data.relationships[o]=e.data.relationships[o]||{},void 0!==t[o]&&angular.extend(e.data.relationships[o],t[o])}),angular.forEach(e.schema.relationships,function(r,o){void 0!==t[o]&&void 0!==t[o].data&&e.__setLink(t[o].data,o,r)})}function A(t,e){var r=this,o=[];return void 0!==t&&(o=E(r.schema.attributes[e],t,e)),o}function b(e){var r=this,o={};return angular.forEach(r.schema.attributes,function(n,a){var i=r.__validateField(e[a],a);i.length>0&&(o[a]=i,t.warn("Erorrs when validating ",e[a],o))}),o}function L(t){var e=this;angular.forEach(e.schema.attributes,function(r,o){t[o]&&(e.data.attributes[o]=t[o])})}function j(t){var e=this,r=angular.copy(t);e.errors.validation=e.__validateData(r),r.relationships=r.relationships||{},r.attributes=r.attributes||{},e.data.id=r.id,e.data.type=r.type,e.__setAttributes(r.attributes),e.__setLinks(r.relationships)}function E(r,o,n){var a=[];if(angular.isArray(r))angular.forEach(r,function(t){a=a.concat(E(t,o,n))});else if(angular.isFunction(r)){var i=r(o);angular.isArray(i)?a.concat(i):t.error("Wrong validator type it should return array of errors instead of: "+i.toString())}else angular.isString(r)?"text"===r||"string"===r?angular.isString(o)||a.push(n+" is not a string "):"number"===r||"integer"===r?parseInt(o).toString()!==o.toString()&&a.push(n+" is not a number"):"uuid4"===r?e.validate(o)||a.push(n+" is not a uuid4"):"required"===r?0===o.toString().length&&a.push(n+" is empty"):t.error("Wrong validator type: "+r.toString()):angular.isObject(r)?(void 0!==r.maxlength&&o.length>r.maxlength&&a.push(n+" is too long max "+r.maxlength),void 0!==r.minlength&&o.length<r.minlength&&a.push(n+" is too short min "+r.minlength),void 0!==r.maxvalue&&parseInt(o)>r.maxvalue&&a.push(n+" is too big max "+r.maxvalue),void 0!==r.minvalue&&parseInt(o)<r.minvalue&&a.push(n+" is too small min "+r.minvalue)):t.error("Wrong validator type: "+r.toString());return a}return n.prototype.__setData=j,n.prototype.__setLinks=k,n.prototype.__setLink=_,n.prototype.__setAttributes=L,n.prototype.__validateData=b,n.prototype.__validateField=A,n.prototype.__updateAttributes=y,n.prototype.__remove=u,n.prototype.__setUpdated=l,n.prototype.__setLinkInternal=m,n.prototype.refresh=a,n.prototype.remove=d,n.prototype.addLinkById=f,n.prototype.addLink=h,n.prototype.removeLink=g,n.prototype.toLink=c,n.prototype.toPatchData=p,n.prototype.removeAllLinks=v,n.prototype.hasErrors=i,n.prototype.toJson=s,n}angular.module("angular-jsonapi").factory("AngularJsonAPIAbstractData",t),t.$inject=["$log","uuid4","lazyProperty","AngularJsonAPIAbstractDataForm"]}(),function(){"use strict";function t(t){function e(t){var e=this;e.data={},e.parent=t,e.reset()}function r(){var e=this,r=e.validate();return angular.equals(r,{})===!1?void t.error("Errors in form: ",r):void e.parent.__updateAttributes(e.data)}function o(){var t=this;angular.forEach(t.parent.schema.attributes,function(e,r){t.data[r]=t.parent.data.attributes[r]||""}),t.errors={validation:{}}}function n(){var t,e=this;return t=e.parent.__validateData(e.data),e.errors.validation=t,t}function a(t){var e,r=this;return e=r.parent.__validateField(r.data[t],t),r.errors.validation[t]=e,e}function i(e){t.log("Synchro Collection "+this.Model.prototype.schema.type,e)}return e.prototype.save=r,e.prototype.reset=o,e.prototype.validate=n,e.prototype.validateField=a,e.prototype.__synchronize=i,e}angular.module("angular-jsonapi").factory("AngularJsonAPIAbstractDataForm",t),t.$inject=["$log"]}(),function(){"use strict";function t(){function t(t,r){function o(t,o){var n=new r(t,o);e[t.type]=n}function n(t){return e[t]}function a(r){return void 0===e[r]&&t.error("Can	 add not existing object type: "+r+". Use initialize(Model, datas)."),e[r].dummy.form}function i(r,o){return void 0===e[r]&&t.error("Can	 get not existing object type: "+r+". Use initialize(Model, datas)."),e[r].get(o)}function s(r,o){return void 0===e[r]&&t.error("Can	 remove not existing object type: "+r+". Use initialize(Model, datas)."),e[r].remove(o)}function l(r){return void 0===e[r]&&t.error("Can	 get all of not existing object type: "+r+". Use initialize(Model, datas)."),e[r].all()}return{form:a,get:i,remove:s,all:l,addModel:o,getModel:n}}var e={};this.$get=t,t.$inject=["$log","AngularJsonAPICollection"]}angular.module("angular-jsonapi").provider("$jsonapi",t)}();
//# sourceMappingURL=angular-jsonapi.min.js.map