!function(){"use strict";angular.module("angular-jsonapi",["uuid4"]).constant("pluralize",pluralize)}(),function(){"use strict";function n(){function n(n,t){return{}}function t(n,t){return[]}var e=this;return e.validateForm=n,e.validateField=t,this}angular.module("angular-jsonapi").service("AngularJsonAPIModelValidatorService",n)}(),function(){"use strict";function n(n){function t(n){return{type:n.data.type,id:n.data.id}}function e(t,e,o,i){return void 0===o?(n.error("Can't link non existing object",t,e,o,i),!1):void 0===t?(n.error("Can't add link to non existing object",t,e,o,i),!1):void 0===i?(n.error("Can't add link not present in schema: ",t,e,o,i),!1):i.polymorphic===!1&&i.model!==o.data.type?(n.error("This relation is not polymorphic, expected: "+i.model+" instead of "+o.data.type),!1):"hasMany"===i.type?a(c,e,t,i):"hasOne"===i.type?r(c,e,t,i):void 0}function o(t,e,o,r){return void 0===r?void n.error("Can't remove link not present in schema: "+e):"hasMany"===r.type?s(c,e,t,r):"hasOne"===r.type?i(c,e,t,r):void 0}function r(e,o,r,a){return n.log("addHasOne",e,o,r,a),e.relationships[o]===r?(n.warn(e,"is already linked to",r),!1):(e.relationships[o]=r,e.data.relationships[o].data=t(r),!0)}function a(e,o,r,a){return n.log("addHasMany",e,o,r,a),e.relationships[o].indexOf(r)>-1?(n.warn(e,"is already linked to",r),!1):(e.relationships[o].push(r),e.data.relationships[o].data.push(t(r)),!0)}function i(t,e,o,r){return n.log("removeHasOne",t,e,o,r),void 0!==o&&t.relationships[e]!==o?(n.warn(t,"is not linked to",o),!1):(t.relationships[e]=null,t.data.relationships[e].data=void 0,!0)}function s(t,e,o,r){if(n.log("removeHasMany",t,e,o,r),void 0===o)t.relationships[e]=[],t.data.relationships[e].data=[];else{var a=t.relationships[e].indexOf(o);if(-1===a)return n.warn(t,"is not linked to",o),!1;t.relationships[e].splice(a,1),t.data.relationships[e].data.splice(a,1)}return!0}var c=this;return c.toLinkData=t,c.link=e,c.unlink=o,this}angular.module("angular-jsonapi").service("AngularJsonAPIModelLinkerService",n),n.$inject=["$log"]}(),function(){"use strict";function n(n,t){function e(n){var t=this;t.data={attributes:{},relationships:{}},t.relationships={},t.parent=n,t.schema=n.schema,t.reset()}function o(){var n=this,t=angular.copy(n.data),e={};return angular.forEach(t.relationships,function(n,t){void 0!==n.data&&(e[t]=n)}),t.relationships=e,{data:t}}function r(){var n=this;return n.parent.save()}function a(){var n=this;angular.forEach(n.schema.attributes,function(t,e){n.data.attributes[e]=n.parent.data.attributes[e]||""}),angular.forEach(n.schema.relationships,function(t,e){n.data.relationships[e]=n.parent.data.relationships[e]||{},n.relationships[e]=n.parent.relationships[e]}),n.errors={validation:{}}}function i(){var t,e=this;return t=n.validateForm(e.data),e.errors.validation=t,t}function s(t){var e,o=this;return e=n.validateField(o.data[t],t),o.errors.validation[t]=e,e}function c(n,e){var o=this,r=o.schema.relationships[n];return t.link(o,n,e,r)}function u(n,e){var o=this,r=o.schema.relationships[n];return t.unlink(o,n,e,r)}return e.prototype.save=r,e.prototype.reset=a,e.prototype.validate=i,e.prototype.validateField=s,e.prototype.link=c,e.prototype.unlink=u,e.prototype.toJson=o,e}angular.module("angular-jsonapi").factory("AngularJsonAPIModelForm",n),n.$inject=["AngularJsonAPIModelValidatorService","AngularJsonAPIModelLinkerService"]}(),function(){"use strict";function n(n,t,e,o,r,a){function i(t,e){var o=this;t.relationships=t.relationships||{},o.isNew=e||!1,o.form=new n(o),o.removed=!1,o.loadingCount=0,o.data={relationships:{},attributes:{}},o.relationships={},o.errors={validation:{}},o.promises={},y(o,t,!0)}function s(){function n(n,t){return y(e,e.form.data),t(),e}function t(n,t){return t(),n}var e=this,o=a.defer(),r=!1,i={action:"update",object:e};e.isNew===!0&&(i.action="add");var s=e.form.validate();for(var c in s)s.hasOwnProperty(c)&&(r=!0);return r===!0?(o.reject(s),o.promise):(e.synchronize(i).then(n,t),o.promise)}function c(){var n=this;return n.form.reset()}function u(){function n(n,t){return o.update(n),t(),o}function t(n,t){return t(),n}var e=a.defer(),o=this,i={action:"refresh",object:o,params:o.schema.params.get};return o.isNew===!0?(r.error("Can't refresh new object"),e.reject("Can't refresh new object")):o.synchronize(i).then(n,t),e.promise}function l(){var n=this,t=angular.copy(n.data),e={};return angular.forEach(t.relationships,function(n,t){void 0!==n.data&&(e[t]=n)}),t.relationships=e,{data:t}}function d(){var n=this;return n.parentFactory.remove(n.data.id)}function p(){var n=this;angular.forEach(n.relationships,function(e,o){t.unlink(n,o,void 0,n.schema.relationships[o])})}function h(n,e){function o(n,t){return s.resolve(c),t(),n}function r(o,r){return t.unlink(c,n,e,u),t.unlink(e,l,c,d),s.reject(o),r(),o}var i,s=a.defer(),c=this,u=c.schema.relationships[n],l=u.reflection,d=e.schema.relationships[l];return t.link(c,n,e,u)&&t.link(e,l,c,d)?(i=a.all(c.synchronize({action:"link",object:c,target:e,key:n}),c.synchronize({action:"linkReflection",object:c,target:e,key:n})),i.then(o,r),s.promise):(s.reject(),s.promise)}function f(n,e){function o(n,t){return s.resolve(c),t(),n}function r(o,r){return t.unlink(c,n,e,u),t.unlink(e,l,c,d),s.reject(o),r(),o}var i,s=a.defer(),c=this,u=c.schema.relationships[n],l=u.reflection,d=e.schema.relationships[l];return t.unlink(c,n,e,u)&&t.unlink(e,l,c,d)?(i=a.all(c.synchronize({action:"unlink",object:c,target:e,key:n}),c.synchronize({action:"unlinkReflection",object:c,target:e,key:n})),i.then(o,r),s.promise):(s.reject(),s.promise)}function y(n,a,i){function s(t,e){n.data.attributes[e]=a.attributes[e]}function c(t,e){void 0===a.relationships[e]?"hasOne"===t.type?n.data.relationships[e]={data:void 0}:"hasMany"===t.type&&(n.data.relationships[e]={data:[]}):(n.data.relationships[e]=a.relationships[e],"hasOne"===t.type?u(n,e,t,n.data.relationships[e].data):"hasMany"===t.type&&angular.forEach(n.data.relationships[e].data,u.bind(void 0,n,e,t)))}function u(n,e,o,r){var a=l.getModel(r.type),s=a.get(r.id),c=o.reflection,u=s.schema.relationships[c];t.link(n,e,s,o),i!==!0&&t.link(n,c,s,u)}var l=o.get("$jsonapi"),d=n.schema;return n.id=a.id,n.type=a.type,n.parentFactory.schema.type!==a.type?(r.error("Different type then factory"),!1):e.validate(n.id)?(a.attributes=a.attributes||{},a.relationships=a.relationships||{},angular.forEach(d.attributes,s),void angular.forEach(d.relationships,c)):(r.error("Invalid id"),!1)}return i.prototype.refresh=u,i.prototype.remove=d,i.prototype.reset=c,i.prototype.save=s,i.prototype.link=h,i.prototype.unlink=f,i.prototype.unlinkAll=p,i.prototype.toJson=l,i}angular.module("angular-jsonapi").factory("AngularJsonAPIAbstractModel",n),n.$inject=["AngularJsonAPIModelForm","AngularJsonAPIModelLinkerService","uuid4","$injector","$log","$q"]}(),function(){"use strict";function n(n){function t(n){var t=this;t.factory=n,t.data={},t.removed={},t.size=0}function e(t){var e=this,o=t.id;return void 0===o?void n.error("Can't add data without id!",t):(void 0===e.data[o]?(e.data[o]=new e.factory.Model(t),e.size+=1):e.data[o].__update(t),e.data[o])}function o(n){var t=this,e=angular.fromJson(n);null!==e&&void 0!==e.data&&(t.updatedAt=e.updatedAt,angular.forEach(e.data,function(n){var e=n.data;t.addOrUpdate(e,n.updatedAt)}))}function r(){var n=this,t={data:{},updatedAt:n.updatedAt};return angular.forEach(n.data,function(n,e){t.data[e]=n.toJson()}),angular.toJson(t)}function a(){var n=this;n.data={},n.removed={}}function i(n){var t=this;return void 0===t.data[n]&&(t.data[n]=new t.factory.Model({id:n,type:t.Model.prototype.schema.type})),t.data[n]}function s(n){var t=this;return void 0!==t.data[n]&&(t.removed[n]=t.data[n],delete t.data[n],t.size-=1),t.removed[n]}function c(n){var t=this;return void 0!==t.removed[n]&&(t.data[n]=t.removed[n],delete t.removed[n],t.size+=1),t.data[n]}function u(n){var t=this;delete t.removed[n]}return t.prototype.get=i,t.prototype.addOrUpdate=e,t.prototype.fromJson=o,t.prototype.toJson=r,t.prototype.clear=a,t.prototype.remove=s,t.prototype.revertRemove=c,t.prototype.clearRemoved=u,t}angular.module("angular-jsonapi").factory("AngularJsonAPICache",n),n.$inject=["$log"]}(),function(){"use strict";angular.module("angular-jsonapi").constant("lazyProperty",function(n,t,e){var o,r;Object.defineProperty(n,t,{get:function(){return r||(r=!0,o=e.call(n)),o},enumerable:!0,configurable:!0})})}(),function(){"use strict";angular.module("angular-jsonapi").constant("toKebabCase",function(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()})}(),function(){"use strict";angular.module("angular-jsonapi").config(["$provide",function(n){n.decorator("$q",["$delegate",function(n){var t=n;return t.allSettled=t.allSettled||function(n,e,o){function r(n){return t.when(n).then(function(n){return angular.isFunction(e)&&e(n),{success:!0,value:n}},function(n){return angular.isFunction(o)&&o(n),{success:!1,reason:n}})}var a=angular.isArray(n)?[]:{};return angular.forEach(n,function(n,t){a.hasOwnProperty(t)||(a[t]=r(n))}),t.all(a)},t}])}])}(),function(){"use strict";function n(n,t,e){function o(t){var e=this;n.call(e,t),angular.forEach(t,function(n){n.synchronizer=e})}function r(o){function r(n){d.notify("synchronization",n)}function a(n){d.notify("synchronization",n)}function i(n){u.state[p].success=!0,angular.forEach(n,function(n){n.success===!1&&(u.state[p].success=!1)}),angular.forEach(u.synchronizations,function(t){angular.forEach(t.afterHooks[p],function(t){d.notify("after",t.call(u,o,n))})});var t,e=[];angular.forEach(n,function(n){n.success===!0?t=n.value:e.push(n.reason)}),void 0===t?d.reject(t,s,e):d.resolve(e,s)}function s(){angular.forEach(u.synchronizations,function(n){angular.forEach(n.finishHooks[p],function(n){d.notify("finish",n.call(u,o))})})}function c(n){e.error("All settled rejected! Something went wrong"),d.reject(n)}var u=this,l=[],d=t.defer(),p=o.action;return n.synchronize.call(u,o),angular.forEach(u.synchronizations,function(n){angular.forEach(n.beginHooks[p],function(n){d.notify("begin",n.call(u,o))})}),angular.forEach(u.synchronizations,function(n){angular.forEach(n.beforeHooks[p],function(n){d.notify("before",n.call(u,o))})}),angular.forEach(u.synchronizations,function(n){angular.forEach(n.synchronizationHooks[p],function(n){l.push(n.call(u,o))})}),t.allSettled(l,r,a).then(i,c),d.promise}return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.synchronize=r,o}angular.module("angular-jsonapi-local",["angular-jsonapi"]).factory("AngularJsonAPISynchronizerSimple",n),n.$inject=["AngularJsonAPISynchronizerPrototype","$q","$log"]}(),function(){"use strict";function n(n){function t(n){var t=this;t.synchronizations=n}function e(t){n.debug("Synchro Collection",this.Model.prototype.schema.type,t),void 0===t.action&&n.error("Can't synchronize undefined action",t)}return t.prototype.synchronize=e,t}angular.module("angular-jsonapi-local",["angular-jsonapi"]).factory("AngularJsonAPISynchronizerPrototype",n),n.$inject=["$log"]}(),function(){"use strict";function n(n,t,e,o,r){function a(a){function i(n){return r({method:"GET",headers:f,url:a,params:n.params||{}})}function s(n){return r({method:"GET",headers:f,url:a+"/"+n.object.data.id,params:n.params||{}})}function c(n){return r({method:"DELETE",headers:f,url:a+"/"+n.object.data.id})}function u(n){var t=o.defer();return n.object.removed===!0||void 0===n.target?t.reject():r({method:"DELETE",headers:f,url:a+"/"+n.object.data.id+"/relationships/"+e(n.key)+"/"+n.target.data.id}).then(t.resolve,t.reject),t.promise}function l(n){var i=o.defer();return n.object.removed===!0||void 0===n.target?i.reject():r({method:"POST",headers:f,url:a+"/"+n.object.data.id+"/relationships/"+e(n.key),data:{data:[t.toLinkData(n.target)]}}).then(i.resolve,i.reject),i.promise}function d(n){return r({method:"PUT",headers:f,url:a+"/"+n.object.data.id,data:n.object.form.toJson()})}function p(n){return r({method:"POST",headers:f,url:a+"/",data:n.object.form.toJson()})}var h=this,f={Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json"};n.call(h),h.synchronization("remove",c),h.synchronization("unlink",u),h.synchronization("link",l),h.synchronization("update",d),h.synchronization("add",p),h.synchronization("all",i),h.synchronization("get",s),h.synchronization("refresh",s)}return a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a}angular.module("angular-jsonapi-rest",["angular-jsonapi"]).factory("AngularJsonAPISynchronizationRest",n),n.$inject=["AngularJsonAPISynchronizationPrototype","AngularJsonAPIModelLinkerService","toKebabCase","$q","$http"]}(),function(){"use strict";function n(){function n(){var n=this,t=["add","init","get","all","clear","remove","unlink","unlinkReflection","link","linkReflection","update","refresh"];n.state={},n.beginHooks={},n.beforeHooks={},n.synchronizationHooks={},n.afterHooks={},n.finishHooks={},n.options={},angular.forEach(t,function(t){n.beginHooks[t]=[],n.beforeHooks[t]=[],n.synchronizationHooks[t]=[],n.afterHooks[t]=[],n.finishHooks[t]=[],n.state[t]={loading:!1,success:!0}})}function t(n,t){var e=this;e.beginHooks[n].push(t)}function e(n,t){var e=this;e.finishHooks[n].push(t)}function o(n,t){var e=this;e.beforeHooks[n].push(t)}function r(n,t){var e=this;e.afterHooks[n].push(t)}function a(n,t){var e=this;e.synchronizationHooks[n].push(t)}return n.prototype.before=o,n.prototype.after=r,n.prototype.begin=t,n.prototype.finish=e,n.prototype.synchronization=a,n}angular.module("angular-jsonapi").factory("AngularJsonAPISynchronizationPrototype",n)}(),function(){"use strict";function n(n,t){function e(e){function o(){return t.localStorage.getItem(e+"."+s)}function r(){t.localStorage.removeItem(e+"."+s)}function a(){t.localStorage.setItem(e+"."+s,c.toJson())}var i=this,s=i.synchronizer.factory.schema.type,c=i.synchronizer.factory.cache;i.__updateStorage=a,n.call(i),i.begin("init",o),i.begin("clear",r),i.begin("remove",a),i.begin("unlink",a),i.begin("unlinkReflection",a),i.begin("link",a),i.begin("linkReflection",a),i.begin("update",a),i.begin("add",a),i.finish("get",a),i.finish("all",a),i.finish("init",a),i.finish("clear",a),i.finish("remove",a),i.finish("unlink",a),i.finish("unlinkReflection",a),i.finish("link",a),i.finish("linkReflection",a),i.finish("update",a),i.finish("add",a),i.finish("get",a),i.finish("all",a)}return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e}angular.module("angular-jsonapi-local",["angular-jsonapi"]).factory("AngularJsonAPISynchronizationLocal",n),n.$inject=["AngularJsonAPISynchronizationPrototype","$window"]}(),function(){"use strict";function n(n,t){function e(n){var t=this,e=n.include||{};n.include=e,e.get=n.include.get||[],e.all=n.include.all||[],t.params={get:{},all:{}},angular.forEach(n.relationships,function(t,r){var a=new o(t,r,n.type);n.relationships[r]=a,a.included===!0&&(e.get.push(r),"hasOne"===a.type&&e.all.push(r))}),angular.extend(t,n),e.get.length>0&&(t.params.get.include=e.get.join(",")),e.all.length>0&&(t.params.all.include=e.all.join(","))}function o(e,o,r){var a=this;angular.isString(e)?(a.model=t.plural(o),a.type=e,a.polymorphic=!1,a.reflection=r):(void 0===e.type&&n.error("Schema of link without a type: ",e,o),a.model=e.model||t.plural(o),a.type=e.type,a.polymorphic=e.polymorphic||!1,a.reflection=e.reflection||r,a.included=e.included||!1)}return e}angular.module("angular-jsonapi").factory("AngularJsonAPISchema",n),n.$inject=["$log","pluralize"]}(),function(){"use strict";function n(n,t,e){function o(t,o){var r=function(t,o,r){var a=this;t.type!==a.schema.type&&e.error("Data type other then declared in schema: ",t.type," instead of ",a.schema.type),n.call(a,t,o,r),a.form.parent=a};return r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype.schema=t,r.prototype.parentFactory=o,r.prototype.synchronize=o.synchronizer.synchronize,angular.forEach(t.functions,function(n,t){r.prototype[t]=function(){return n.apply(this,arguments)}}),r}return{model:o}}angular.module("angular-jsonapi").factory("AngularJsonAPIModel",n),n.$inject=["AngularJsonAPIAbstractModel","AngularJsonAPISchema","$log"]}(),function(){"use strict";function n(n,t,e,o,r,a,i){function s(o,r){function a(n,t){return s.cache.fromJson(n),t(),n}function i(n,t){return t(),n}var s=this,c={action:"init"};s.schema=new t(o),s.cache=new e(s),s.synchronizer=r,s.synchronizer.factory=s,s.Model=n.model(s.schema,s),s.synchronizer.synchronize(c).then(a,i)}function c(n){var t=this,e=t.__get(n);return e.fetch(),e}function u(n){var t=this,e=new o(t,angular.extend(n,t.schema.params.all));return e.fetch(),e}function l(n){function t(t,e){return r.unlinkAll(),o.cache.clearRemoved(n),e(),t}function e(t,e){return void 0!==r&&(r.removed=!1,o.cache.revertRemove(n)),e(),t}var o=this,r=o.cache.remove(n),s={action:"remove",object:r};if(void 0!==r){if(r.removed=!0,r.isNew)return i.when(void 0)}else a.error("Object with this id does not exist");return o.synchronizer.synchronize(s).then(t,e)}function d(){var n=this,t=new n.Model({type:n.schema.type,id:r.generate(),attributes:{},relationships:{}},!0);return t}function p(){function n(n,t){t()}function t(n,t){return t(),n}var e=this;e.cache.clear();var o={action:"clear"};return e.synchronizer.synchronize(o).then(n,t)}return s.prototype.get=c,s.prototype.all=u,s.prototype.remove=l,s.prototype.initialize=d,s.prototype.clear=p,s}angular.module("angular-jsonapi").factory("AngularJsonAPIFactory",n),n.$inject=["AngularJsonAPIModel","AngularJsonAPISchema","AngularJsonAPICache","AngularJsonAPICollection","uuid4","$log","$q"]}(),function(){"use strict";function n(){function n(n,t){var e=this;e.factory=n,e.params=t,e.errors={synchronization:[]},e.data=[],e.step="initialized"}function t(){function n(n){return o.errors.synchronization=[],o.data=n,o}function t(n){return o.errors.synchronization=n,o}function e(n,t){return void 0!==n&&(o.data=n),o.step=t,o}var o=this,r={method:"all",params:o.params};return o.factory.__synchronize(r).then(n,t,e)}return n.prototype.fetch=t,n.prototype.refresh=t,n}angular.module("angular-jsonapi").factory("AngularJsonAPICollection",n)}(),function(){"use strict";function n(){function n(n,e){function o(n,o){var r=new e(n,o);t[n.type]=r}function r(n){return t[n]}function a(e){return void 0===t[e]&&n.error("Can	 add not existing object type: "+e+". Use initialize(Model, datas)."),t[e].isNew.form}function i(e,o){return void 0===t[e]&&n.error("Can	 get not existing object type: "+e+". Use initialize(Model, datas)."),t[e].get(o)}function s(e,o){return void 0===t[e]&&n.error("Can	 remove not existing object type: "+e+". Use initialize(Model, datas)."),t[e].remove(o)}function c(e){return void 0===t[e]&&n.error("Can	 get all of not existing object type: "+e+". Use initialize(Model, datas)."),t[e].all()}function u(){angular.forEach(t,function(n){n.clear()})}return{form:a,get:i,remove:s,all:c,addModel:o,getModel:r,clearAll:u}}var t={};this.$get=n,n.$inject=["$log","AngularJsonAPIFactory"]}angular.module("angular-jsonapi").provider("$jsonapi",n)}();
//# sourceMappingURL=angular-jsonapi.min.js.map